{"ast":null,"code":"var _jsxFileName = \"/Users/mirustal/Documents/project/rooms/front/rooms/src/components/views/Channels/ChannelView.jsx\",\n    _s = $RefreshSig$();\n\nimport { Icon16DeleteOutline, Icon16PenOutline, Icon24RefreshOutline, Icon28VolumeOutline } from \"@vkontakte/icons\";\nimport { IconButton, SimpleCell, Tooltip } from \"@vkontakte/vkui\";\nimport { joinCall } from \"../../../bridge/bridgeLib\";\nimport { Locales } from \"../../../locales/locales\";\nimport { useContext, useEffect, useState } from \"react\";\nimport { AlertManagerContext, TipAlert } from \"../../contexts/AlertProvider\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ChannelView(_ref) {\n  _s();\n\n  let {\n    channel,\n    channelIndex,\n    editModeActive,\n    refreshChannel,\n    userIsAdmin\n  } = _ref;\n  const [isTipShown, setTipShown] = useState(channelIndex == 0);\n  const alerts = useContext(AlertManagerContext);\n  useEffect(() => {\n    let counter = localStorage.getItem(\"tipCounter\");\n\n    if (counter == null) {\n      localStorage.setItem(\"tipCounter\", \"1\");\n      return;\n    }\n\n    let counterVal = JSON.parse(counter);\n\n    if (counterVal > 3) {\n      setTipShown(false);\n    }\n\n    localStorage.setItem(\"tipCounter\", JSON.stringify(counterVal + 1));\n  }, []);\n\n  function joinChannel() {\n    joinCall(channel.joinlink, () => {});\n  }\n\n  const handleIconButtonClick = action => e => {\n    e.preventDefault();\n    e.stopPropagation();\n    action();\n  };\n\n  return /*#__PURE__*/_jsxDEV(SimpleCell, {\n    before: /*#__PURE__*/_jsxDEV(Icon28VolumeOutline, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 15\n    }, this),\n    after: userIsAdmin && /*#__PURE__*/_jsxDEV(Tooltip, {\n      isShown: isTipShown,\n      text: Locales.Hints.RefreshChannel,\n      onClick: e => {\n        e.preventDefault();\n        e.stopPropagation();\n        e.nativeEvent.stopImmediatePropagation();\n        setTipShown(false);\n      },\n      onClose: () => setTipShown(false),\n      children: /*#__PURE__*/_jsxDEV(IconButton, {\n        onClick: e => {\n          e.preventDefault();\n          e.stopPropagation();\n          e.nativeEvent.stopImmediatePropagation();\n          refreshChannel(channel.id);\n        },\n        children: /*#__PURE__*/_jsxDEV(Icon24RefreshOutline, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 9\n    }, this),\n    onClick: () => {\n      if (!userIsAdmin) {\n        joinChannel();\n        return;\n      }\n\n      let isFirstCall = localStorage.getItem(\"isFirstCall\");\n\n      if (isFirstCall == null) {\n        localStorage.setItem(\"isFirstCall\", \"false\");\n        alerts.showAlert(TipAlert({\n          message: Locales.Hints.DontKillCall,\n          alertManager: alerts,\n          onClose: joinChannel\n        }));\n        return;\n      }\n\n      joinChannel();\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        alignItems: 'center'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"b\", {\n        children: [\"#\", channel.name]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this), editModeActive && /*#__PURE__*/_jsxDEV(IconButton, {\n        onClick: e => {\n          e.preventDefault();\n          e.stopPropagation();\n          e.nativeEvent.stopImmediatePropagation();\n          renameToChannel();\n        },\n        children: /*#__PURE__*/_jsxDEV(Icon16PenOutline, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 28\n      }, this), editModeActive && /*#__PURE__*/_jsxDEV(IconButton, {\n        style: {\n          color: 'red'\n        },\n        onClick: e => {\n          e.preventDefault();\n          e.stopPropagation();\n          e.nativeEvent.stopImmediatePropagation();\n          deleteToChannel(channel.id);\n        },\n        children: /*#__PURE__*/_jsxDEV(Icon16DeleteOutline, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 28\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 44,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ChannelView, \"ZEe6p9QPxuPigHUrhXk0L7nuhmA=\");\n\n_c = ChannelView;\n\nvar _c;\n\n$RefreshReg$(_c, \"ChannelView\");","map":{"version":3,"names":["Icon16DeleteOutline","Icon16PenOutline","Icon24RefreshOutline","Icon28VolumeOutline","IconButton","SimpleCell","Tooltip","joinCall","Locales","useContext","useEffect","useState","AlertManagerContext","TipAlert","ChannelView","channel","channelIndex","editModeActive","refreshChannel","userIsAdmin","isTipShown","setTipShown","alerts","counter","localStorage","getItem","setItem","counterVal","JSON","parse","stringify","joinChannel","joinlink","handleIconButtonClick","action","e","preventDefault","stopPropagation","Hints","RefreshChannel","nativeEvent","stopImmediatePropagation","id","isFirstCall","showAlert","message","DontKillCall","alertManager","onClose","display","alignItems","name","renameToChannel","color","deleteToChannel"],"sources":["/Users/mirustal/Documents/project/rooms/front/rooms/src/components/views/Channels/ChannelView.jsx"],"sourcesContent":["import {\n  Icon16DeleteOutline,\n  Icon16PenOutline,\n  Icon24RefreshOutline,\n  Icon28VolumeOutline,\n} from \"@vkontakte/icons\";\nimport { IconButton, SimpleCell, Tooltip } from \"@vkontakte/vkui\";\nimport { joinCall } from \"../../../bridge/bridgeLib\";\nimport { Locales } from \"../../../locales/locales\";\nimport { useContext, useEffect, useState } from \"react\";\nimport { AlertManagerContext, TipAlert } from \"../../contexts/AlertProvider\";\n\nexport default function ChannelView({ channel, channelIndex, editModeActive, refreshChannel, userIsAdmin }) {\n\n  const [isTipShown, setTipShown] = useState(channelIndex == 0)\n  \n  const alerts = useContext(AlertManagerContext)\n\n  useEffect(() => {\n    let counter = localStorage.getItem(\"tipCounter\")\n    if (counter == null){\n      localStorage.setItem(\"tipCounter\", \"1\")\n      return\n    }\n    let counterVal = JSON.parse(counter)\n    if (counterVal > 3) {\n      setTipShown(false)\n    }\n    localStorage.setItem(\"tipCounter\", JSON.stringify(counterVal + 1))\n  }, [])\n\n  function joinChannel() {\n    joinCall(channel.joinlink, () => {})\n  }\n\n  const handleIconButtonClick = (action) => (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    action();\n  };\n\n  \n  return (\n    <SimpleCell\n      before={<Icon28VolumeOutline />}\n      after={\n        userIsAdmin &&\n        <Tooltip\n              isShown={isTipShown}\n              text={Locales.Hints.RefreshChannel}\n              onClick={e => {\n                e.preventDefault()\n                e.stopPropagation()\n                e.nativeEvent.stopImmediatePropagation()\n                setTipShown(false)\n              }}\n              onClose={() => setTipShown(false)}\n            >\n          <IconButton onClick={e => {\n            e.preventDefault()\n            e.stopPropagation()\n            e.nativeEvent.stopImmediatePropagation()\n            refreshChannel(channel.id)\n          }}>\n              \n                <Icon24RefreshOutline />\n          </IconButton>\n        </Tooltip>\n      }\n      onClick={() => {\n        if (!userIsAdmin){\n          joinChannel()\n          return\n        }\n        let isFirstCall = localStorage.getItem(\"isFirstCall\")\n        if (isFirstCall == null){\n          localStorage.setItem(\"isFirstCall\", \"false\")\n          alerts.showAlert(TipAlert({message: Locales.Hints.DontKillCall, alertManager: alerts, onClose: joinChannel}))\n          return\n        }\n        joinChannel()\n      }}\n    >\n      <div style={{ display: 'flex', alignItems: 'center' }}>\n        <b>#{channel.name}</b>\n        {editModeActive && <IconButton\n          onClick={e => {\n            e.preventDefault()\n            e.stopPropagation()\n            e.nativeEvent.stopImmediatePropagation()\n            renameToChannel()\n            }}>\n          <Icon16PenOutline />\n        </IconButton>}\n        {editModeActive && <IconButton\n          style={{ color: 'red' }}\n          onClick={e => {\n            e.preventDefault()\n            e.stopPropagation()\n            e.nativeEvent.stopImmediatePropagation()\n            deleteToChannel(channel.id)\n            }}>\n          <Icon16DeleteOutline />\n        </IconButton>}\n\n      </div>\n\n    </SimpleCell>\n  );\n}\n"],"mappings":";;;AAAA,SACEA,mBADF,EAEEC,gBAFF,EAGEC,oBAHF,EAIEC,mBAJF,QAKO,kBALP;AAMA,SAASC,UAAT,EAAqBC,UAArB,EAAiCC,OAAjC,QAAgD,iBAAhD;AACA,SAASC,QAAT,QAAyB,2BAAzB;AACA,SAASC,OAAT,QAAwB,0BAAxB;AACA,SAASC,UAAT,EAAqBC,SAArB,EAAgCC,QAAhC,QAAgD,OAAhD;AACA,SAASC,mBAAT,EAA8BC,QAA9B,QAA8C,8BAA9C;;AAEA,eAAe,SAASC,WAAT,OAA6F;EAAA;;EAAA,IAAxE;IAAEC,OAAF;IAAWC,YAAX;IAAyBC,cAAzB;IAAyCC,cAAzC;IAAyDC;EAAzD,CAAwE;EAE1G,MAAM,CAACC,UAAD,EAAaC,WAAb,IAA4BV,QAAQ,CAACK,YAAY,IAAI,CAAjB,CAA1C;EAEA,MAAMM,MAAM,GAAGb,UAAU,CAACG,mBAAD,CAAzB;EAEAF,SAAS,CAAC,MAAM;IACd,IAAIa,OAAO,GAAGC,YAAY,CAACC,OAAb,CAAqB,YAArB,CAAd;;IACA,IAAIF,OAAO,IAAI,IAAf,EAAoB;MAClBC,YAAY,CAACE,OAAb,CAAqB,YAArB,EAAmC,GAAnC;MACA;IACD;;IACD,IAAIC,UAAU,GAAGC,IAAI,CAACC,KAAL,CAAWN,OAAX,CAAjB;;IACA,IAAII,UAAU,GAAG,CAAjB,EAAoB;MAClBN,WAAW,CAAC,KAAD,CAAX;IACD;;IACDG,YAAY,CAACE,OAAb,CAAqB,YAArB,EAAmCE,IAAI,CAACE,SAAL,CAAeH,UAAU,GAAG,CAA5B,CAAnC;EACD,CAXQ,EAWN,EAXM,CAAT;;EAaA,SAASI,WAAT,GAAuB;IACrBxB,QAAQ,CAACQ,OAAO,CAACiB,QAAT,EAAmB,MAAM,CAAE,CAA3B,CAAR;EACD;;EAED,MAAMC,qBAAqB,GAAIC,MAAD,IAAaC,CAAD,IAAO;IAC/CA,CAAC,CAACC,cAAF;IACAD,CAAC,CAACE,eAAF;IACAH,MAAM;EACP,CAJD;;EAOA,oBACE,QAAC,UAAD;IACE,MAAM,eAAE,QAAC,mBAAD;MAAA;MAAA;MAAA;IAAA,QADV;IAEE,KAAK,EACHf,WAAW,iBACX,QAAC,OAAD;MACM,OAAO,EAAEC,UADf;MAEM,IAAI,EAAEZ,OAAO,CAAC8B,KAAR,CAAcC,cAF1B;MAGM,OAAO,EAAEJ,CAAC,IAAI;QACZA,CAAC,CAACC,cAAF;QACAD,CAAC,CAACE,eAAF;QACAF,CAAC,CAACK,WAAF,CAAcC,wBAAd;QACApB,WAAW,CAAC,KAAD,CAAX;MACD,CARP;MASM,OAAO,EAAE,MAAMA,WAAW,CAAC,KAAD,CAThC;MAAA,uBAWE,QAAC,UAAD;QAAY,OAAO,EAAEc,CAAC,IAAI;UACxBA,CAAC,CAACC,cAAF;UACAD,CAAC,CAACE,eAAF;UACAF,CAAC,CAACK,WAAF,CAAcC,wBAAd;UACAvB,cAAc,CAACH,OAAO,CAAC2B,EAAT,CAAd;QACD,CALD;QAAA,uBAOM,QAAC,oBAAD;UAAA;UAAA;UAAA;QAAA;MAPN;QAAA;QAAA;QAAA;MAAA;IAXF;MAAA;MAAA;MAAA;IAAA,QAJJ;IA0BE,OAAO,EAAE,MAAM;MACb,IAAI,CAACvB,WAAL,EAAiB;QACfY,WAAW;QACX;MACD;;MACD,IAAIY,WAAW,GAAGnB,YAAY,CAACC,OAAb,CAAqB,aAArB,CAAlB;;MACA,IAAIkB,WAAW,IAAI,IAAnB,EAAwB;QACtBnB,YAAY,CAACE,OAAb,CAAqB,aAArB,EAAoC,OAApC;QACAJ,MAAM,CAACsB,SAAP,CAAiB/B,QAAQ,CAAC;UAACgC,OAAO,EAAErC,OAAO,CAAC8B,KAAR,CAAcQ,YAAxB;UAAsCC,YAAY,EAAEzB,MAApD;UAA4D0B,OAAO,EAAEjB;QAArE,CAAD,CAAzB;QACA;MACD;;MACDA,WAAW;IACZ,CAtCH;IAAA,uBAwCE;MAAK,KAAK,EAAE;QAAEkB,OAAO,EAAE,MAAX;QAAmBC,UAAU,EAAE;MAA/B,CAAZ;MAAA,wBACE;QAAA,gBAAKnC,OAAO,CAACoC,IAAb;MAAA;QAAA;QAAA;QAAA;MAAA,QADF,EAEGlC,cAAc,iBAAI,QAAC,UAAD;QACjB,OAAO,EAAEkB,CAAC,IAAI;UACZA,CAAC,CAACC,cAAF;UACAD,CAAC,CAACE,eAAF;UACAF,CAAC,CAACK,WAAF,CAAcC,wBAAd;UACAW,eAAe;QACd,CANc;QAAA,uBAOjB,QAAC,gBAAD;UAAA;UAAA;UAAA;QAAA;MAPiB;QAAA;QAAA;QAAA;MAAA,QAFrB,EAWGnC,cAAc,iBAAI,QAAC,UAAD;QACjB,KAAK,EAAE;UAAEoC,KAAK,EAAE;QAAT,CADU;QAEjB,OAAO,EAAElB,CAAC,IAAI;UACZA,CAAC,CAACC,cAAF;UACAD,CAAC,CAACE,eAAF;UACAF,CAAC,CAACK,WAAF,CAAcC,wBAAd;UACAa,eAAe,CAACvC,OAAO,CAAC2B,EAAT,CAAf;QACC,CAPc;QAAA,uBAQjB,QAAC,mBAAD;UAAA;UAAA;UAAA;QAAA;MARiB;QAAA;QAAA;QAAA;MAAA,QAXrB;IAAA;MAAA;MAAA;MAAA;IAAA;EAxCF;IAAA;IAAA;IAAA;EAAA,QADF;AAmED;;GAjGuB5B,W;;KAAAA,W"},"metadata":{},"sourceType":"module"}