{"ast":null,"code":"import _slicedToArray from\"/Users/mirustal/Documents/project/rooms/front/rooms/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Icon16DeleteOutline,Icon16PenOutline,Icon24RefreshOutline,Icon28VolumeOutline}from\"@vkontakte/icons\";import{IconButton,SimpleCell,Tooltip}from\"@vkontakte/vkui\";import{joinCall}from\"../../../bridge/bridgeLib\";import{Locales}from\"../../../locales/locales\";import{useContext,useEffect,useState}from\"react\";import{AlertManagerContext,TipAlert}from\"../../contexts/AlertProvider\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function ChannelView(_ref){var channel=_ref.channel,channelIndex=_ref.channelIndex,renameToChannel=_ref.renameToChannel,editModeActive=_ref.editModeActive,deleteToChannel=_ref.deleteToChannel,refreshChannel=_ref.refreshChannel,userIsAdmin=_ref.userIsAdmin;var _useState=useState(channelIndex==0),_useState2=_slicedToArray(_useState,2),isTipShown=_useState2[0],setTipShown=_useState2[1];var alerts=useContext(AlertManagerContext);useEffect(function(){var counter=localStorage.getItem(\"tipCounter\");if(counter==null){localStorage.setItem(\"tipCounter\",\"1\");return;}var counterVal=JSON.parse(counter);if(counterVal>3){setTipShown(false);}localStorage.setItem(\"tipCounter\",JSON.stringify(counterVal+1));},[]);function joinChannel(){joinCall(channel.joinlink,function(){});}return/*#__PURE__*/_jsx(SimpleCell,{before:/*#__PURE__*/_jsx(Icon28VolumeOutline,{}),after:userIsAdmin&&/*#__PURE__*/_jsx(Tooltip,{isShown:isTipShown,text:Locales.Hints.RefreshChannel,onClick:function onClick(e){e.preventDefault();e.stopPropagation();e.nativeEvent.stopImmediatePropagation();setTipShown(false);},onClose:function onClose(){return setTipShown(false);},children:/*#__PURE__*/_jsx(IconButton,{onClick:function onClick(e){e.preventDefault();e.stopPropagation();e.nativeEvent.stopImmediatePropagation();refreshChannel(channel.id);},children:/*#__PURE__*/_jsx(Icon24RefreshOutline,{})})}),onClick:function onClick(){if(!userIsAdmin){joinChannel();return;}var isFirstCall=localStorage.getItem(\"isFirstCall\");if(isFirstCall==null){localStorage.setItem(\"isFirstCall\",\"false\");alerts.showAlert(TipAlert({message:Locales.Hints.DontKillCall,alertManager:alerts,onClose:joinChannel}));return;}joinChannel();},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"b\",{children:[\"#\",channel.name]}),editModeActive&&/*#__PURE__*/_jsx(IconButton,{onClick:function onClick(e){e.preventDefault();e.stopPropagation();e.nativeEvent.stopImmediatePropagation();renameToChannel();},children:/*#__PURE__*/_jsx(Icon16PenOutline,{})}),editModeActive&&/*#__PURE__*/_jsx(IconButton,{style:{color:'red'},onClick:function onClick(){e.preventDefault();e.stopPropagation();e.nativeEvent.stopImmediatePropagation();deleteToChannel(channel.id);},children:/*#__PURE__*/_jsx(Icon16DeleteOutline,{})})]})});}","map":{"version":3,"names":["Icon16DeleteOutline","Icon16PenOutline","Icon24RefreshOutline","Icon28VolumeOutline","IconButton","SimpleCell","Tooltip","joinCall","Locales","useContext","useEffect","useState","AlertManagerContext","TipAlert","ChannelView","channel","channelIndex","renameToChannel","editModeActive","deleteToChannel","refreshChannel","userIsAdmin","isTipShown","setTipShown","alerts","counter","localStorage","getItem","setItem","counterVal","JSON","parse","stringify","joinChannel","joinlink","Hints","RefreshChannel","e","preventDefault","stopPropagation","nativeEvent","stopImmediatePropagation","id","isFirstCall","showAlert","message","DontKillCall","alertManager","onClose","display","alignItems","name","color"],"sources":["/Users/mirustal/Documents/project/rooms/front/rooms/src/components/views/Channels/ChannelView.jsx"],"sourcesContent":["import {\n  Icon16DeleteOutline,\n  Icon16PenOutline,\n  Icon24RefreshOutline,\n  Icon28VolumeOutline,\n} from \"@vkontakte/icons\";\nimport { IconButton, SimpleCell, Tooltip } from \"@vkontakte/vkui\";\nimport { joinCall } from \"../../../bridge/bridgeLib\";\nimport { Locales } from \"../../../locales/locales\";\nimport { useContext, useEffect, useState } from \"react\";\nimport { AlertManagerContext, TipAlert } from \"../../contexts/AlertProvider\";\n\nexport default function ChannelView({ channel, channelIndex, renameToChannel, editModeActive, deleteToChannel, refreshChannel, userIsAdmin }) {\n\n  const [isTipShown, setTipShown] = useState(channelIndex == 0)\n  \n  const alerts = useContext(AlertManagerContext)\n\n  useEffect(() => {\n    let counter = localStorage.getItem(\"tipCounter\")\n    if (counter == null){\n      localStorage.setItem(\"tipCounter\", \"1\")\n      return\n    }\n    let counterVal = JSON.parse(counter)\n    if (counterVal > 3) {\n      setTipShown(false)\n    }\n    localStorage.setItem(\"tipCounter\", JSON.stringify(counterVal + 1))\n  }, [])\n\n  function joinChannel() {\n    joinCall(channel.joinlink, () => {})\n  }\n\n  return (\n    <SimpleCell\n      before={<Icon28VolumeOutline />}\n      after={\n        userIsAdmin &&\n        <Tooltip\n              isShown={isTipShown}\n              text={Locales.Hints.RefreshChannel}\n              onClick={e => {\n                e.preventDefault()\n                e.stopPropagation()\n                e.nativeEvent.stopImmediatePropagation()\n                setTipShown(false)\n              }}\n              onClose={() => setTipShown(false)}\n            >\n          <IconButton onClick={e => {\n            e.preventDefault()\n            e.stopPropagation()\n            e.nativeEvent.stopImmediatePropagation()\n            refreshChannel(channel.id)\n          }}>\n              \n                <Icon24RefreshOutline />\n          </IconButton>\n        </Tooltip>\n      }\n      onClick={() => {\n        if (!userIsAdmin){\n          joinChannel()\n          return\n        }\n        let isFirstCall = localStorage.getItem(\"isFirstCall\")\n        if (isFirstCall == null){\n          localStorage.setItem(\"isFirstCall\", \"false\")\n          alerts.showAlert(TipAlert({message: Locales.Hints.DontKillCall, alertManager: alerts, onClose: joinChannel}))\n          return\n        }\n        joinChannel()\n      }}\n    >\n      <div style={{ display: 'flex', alignItems: 'center' }}>\n        <b>#{channel.name}</b>\n        {editModeActive && <IconButton\n          onClick={e => {\n            e.preventDefault()\n            e.stopPropagation()\n            e.nativeEvent.stopImmediatePropagation()\n            renameToChannel()\n            }}>\n          <Icon16PenOutline />\n        </IconButton>}\n        {editModeActive && <IconButton\n          style={{ color: 'red' }}\n          onClick={() => {\n            e.preventDefault()\n            e.stopPropagation()\n            e.nativeEvent.stopImmediatePropagation()\n            deleteToChannel(channel.id)\n            }}>\n          <Icon16DeleteOutline />\n        </IconButton>}\n\n      </div>\n\n    </SimpleCell>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}