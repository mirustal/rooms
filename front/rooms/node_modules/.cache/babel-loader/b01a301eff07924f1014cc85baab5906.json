{"ast":null,"code":"var _jsxFileName = \"/Users/mirustal/Documents/project/rooms/front/rooms/src/components/views/Channels/Channels.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useState } from \"react\";\nimport { View, Panel, Group, PanelHeader, PanelHeaderBack, CellButton, Div, PanelHeaderContent, PanelHeaderButton } from \"@vkontakte/vkui\";\nimport { ModalIds, Views } from \"../../../model/views\";\nimport ChannelView from \"./ChannelView\";\nimport { Icon16Dropdown, Icon24Add, Icon28AddOutline } from \"@vkontakte/icons\";\nimport AlterActionSheet from \"./AlterActionSheet\";\nimport { AlertManagerContext } from \"../../contexts/AlertProvider\";\nimport useAdminStatus from \"./hooks/AdminStatus\";\nimport { ModalManager } from \"../../Modals\";\nimport { Locales } from \"../../../locales/locales\";\nimport { roomOperation } from \"./utils/roomOperation\";\nimport { openBaseWithAction } from \"../../Snackbar\";\nimport { getVkUserId } from \"../../../bridge/bridgeLib\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function Channels(_ref) {\n  _s();\n\n  let {\n    roomManager,\n    returnBack\n  } = _ref;\n  const [editModeActive, setEditModeActive] = useState(false);\n  const userIsAdmin = useAdminStatus(roomManager.room);\n  const alerts = useContext(AlertManagerContext);\n  const roomOper = roomOperation(roomManager, alerts);\n  const [channels, setChannels] = useState(roomManager.channels);\n  const [snackbar, setSnackbar] = useState(null);\n  const vkUserId = getVkUserId();\n  const [contextOpened, setContextOpened] = React.useState(false);\n\n  const toggleContext = () => {\n    setContextOpened(prev => !prev);\n  };\n\n  const toggleEditMode = () => {\n    setEditModeActive(!editModeActive);\n    openBaseWithAction(snackbar, setSnackbar, editModeActive);\n  };\n\n  const showModal = (modalId, props) => {\n    ModalManager.showModal(modalId, props);\n  };\n\n  return roomManager.room ? roomManager.room.channels.map(channel => !channel.name.toLowerCase().includes(searchValue.toLowerCase())) && /*#__PURE__*/_jsxDEV(View, {\n    id: Views.Rooms.id,\n    activePanel: Views.Rooms.panels.list.id,\n    children: /*#__PURE__*/_jsxDEV(Panel, {\n      id: Views.Rooms.panels.list.id,\n      children: [/*#__PURE__*/_jsxDEV(PanelHeader, {\n        before: /*#__PURE__*/_jsxDEV(PanelHeaderBack, {\n          onClick: returnBack\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 53,\n          columnNumber: 30\n        }, this),\n        after: /*#__PURE__*/_jsxDEV(PanelHeaderButton, {\n          children: /*#__PURE__*/_jsxDEV(Icon28AddOutline, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 55,\n            columnNumber: 19\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 17\n        }, this),\n        children: /*#__PURE__*/_jsxDEV(PanelHeaderContent, {\n          aside: /*#__PURE__*/_jsxDEV(Icon16Dropdown, {\n            style: {\n              transform: `rotate(${contextOpened ? '180deg' : '0'})`\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 60,\n            columnNumber: 17\n          }, this),\n          onClick: toggleContext,\n          children: roomManager.room.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 9\n      }, this), AlterActionSheet({\n        roomInfo: roomManager.room,\n        returnBack: () => returnBack(),\n        handleActiveEditMode: toggleEditMode,\n        userIsAdmin: userIsAdmin,\n        deleteMember: () => roomOper.deleteMember(vkUserId),\n        deleteRoom: () => roomOper.deleteRoom(roomManager.room.id, returnBack),\n        contextOpened: contextOpened,\n        toggleContext: toggleContext\n      }), /*#__PURE__*/_jsxDEV(Group, {\n        children: [roomManager.room.channels.map((channel, index) => /*#__PURE__*/_jsxDEV(ChannelView, {\n          channelIndex: index,\n          channel: channel,\n          renameToChannel: () => showModal(ModalIds.RenameChannel, {\n            renameChannelId: channel.id,\n            renameChannel: roomOper.renameChannel\n          }),\n          deleteToChannel: () => {\n            roomOper.deleteChannel(channel.id);\n            setChannels(roomManager.room.channels);\n          },\n          editModeActive: editModeActive,\n          refreshChannel: () => roomOper.refreshChannel(channel.id),\n          userIsAdmin: userIsAdmin\n        }, channel.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 13\n        }, this)), userIsAdmin && /*#__PURE__*/_jsxDEV(CellButton, {\n          onClick: () => showModal(ModalIds.CreateChannel, {\n            createChannel: roomOper.createChannel\n          }),\n          centered: true,\n          before: /*#__PURE__*/_jsxDEV(Icon24Add, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 23\n          }, this),\n          children: Locales.Channels.CreateChannel\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: snackbar\n      }, void 0, false)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 51,\n    columnNumber: 5\n  }, this) : null;\n}\n\n_s(Channels, \"If19Yr/FIMoXEhUDcx+NiRQYwTc=\", false, function () {\n  return [useAdminStatus];\n});\n\n_c = Channels;\n\nvar _c;\n\n$RefreshReg$(_c, \"Channels\");","map":{"version":3,"names":["React","useContext","useState","View","Panel","Group","PanelHeader","PanelHeaderBack","CellButton","Div","PanelHeaderContent","PanelHeaderButton","ModalIds","Views","ChannelView","Icon16Dropdown","Icon24Add","Icon28AddOutline","AlterActionSheet","AlertManagerContext","useAdminStatus","ModalManager","Locales","roomOperation","openBaseWithAction","getVkUserId","Channels","roomManager","returnBack","editModeActive","setEditModeActive","userIsAdmin","room","alerts","roomOper","channels","setChannels","snackbar","setSnackbar","vkUserId","contextOpened","setContextOpened","toggleContext","prev","toggleEditMode","showModal","modalId","props","map","channel","name","toLowerCase","includes","searchValue","Rooms","id","panels","list","transform","roomInfo","handleActiveEditMode","deleteMember","deleteRoom","index","RenameChannel","renameChannelId","renameChannel","deleteChannel","refreshChannel","CreateChannel","createChannel"],"sources":["/Users/mirustal/Documents/project/rooms/front/rooms/src/components/views/Channels/Channels.jsx"],"sourcesContent":["import React, { useContext, useState } from \"react\";\nimport {\n  View,\n  Panel,\n  Group,\n  PanelHeader,\n  PanelHeaderBack,\n  CellButton,\n  Div,\n  PanelHeaderContent,\n  PanelHeaderButton,\n} from \"@vkontakte/vkui\";\nimport { ModalIds, Views } from \"../../../model/views\";\nimport ChannelView from \"./ChannelView\";\nimport { Icon16Dropdown, Icon24Add, Icon28AddOutline } from \"@vkontakte/icons\";\nimport AlterActionSheet from \"./AlterActionSheet\";\nimport { AlertManagerContext } from \"../../contexts/AlertProvider\";\nimport useAdminStatus from \"./hooks/AdminStatus\";\nimport { ModalManager } from \"../../Modals\";\nimport { Locales } from \"../../../locales/locales\";\nimport { roomOperation } from \"./utils/roomOperation\";\nimport { openBaseWithAction } from \"../../Snackbar\";\nimport { getVkUserId } from \"../../../bridge/bridgeLib\";\n\nexport default function Channels({ roomManager, returnBack }) {\n  const [editModeActive, setEditModeActive] = useState(false);\n  const userIsAdmin = useAdminStatus(roomManager.room);\n  const alerts = useContext(AlertManagerContext);\n  const roomOper = roomOperation(roomManager, alerts);\n  const [channels, setChannels] = useState(roomManager.channels)\n  const [snackbar, setSnackbar] = useState(null)\n  const vkUserId = getVkUserId();\n  const [contextOpened, setContextOpened] = React.useState(false);\n  const toggleContext = () => {\n    setContextOpened((prev) => !prev);\n  };\n\n\n\n  const toggleEditMode = () => {\n    setEditModeActive(!editModeActive);\n    openBaseWithAction(snackbar, setSnackbar, editModeActive);\n  }\n\n  const showModal = (modalId, props) => {\n    ModalManager.showModal(modalId, props);\n  };\n\n  return roomManager.room ?  (\n    roomManager.room.channels.map((channel, ) => (!channel.name.toLowerCase().includes(searchValue.toLowerCase())))  &&\n    <View id={Views.Rooms.id} activePanel={Views.Rooms.panels.list.id}>\n      <Panel id={Views.Rooms.panels.list.id}>\n        <PanelHeader before={<PanelHeaderBack onClick={returnBack} />} after={\n                <PanelHeaderButton>\n                  <Icon28AddOutline />\n                </PanelHeaderButton>\n              }>\n            <PanelHeaderContent\n              aside={\n                <Icon16Dropdown\n                  style={{\n                    transform: `rotate(${contextOpened ? '180deg' : '0'})`,\n                  }}\n                />\n              }\n              onClick={toggleContext}\n            >\n              {roomManager.room.name}\n            </PanelHeaderContent>\n        </PanelHeader>\n        {AlterActionSheet({\n              roomInfo:roomManager.room,\n              returnBack:() => returnBack(),\n              handleActiveEditMode: toggleEditMode,\n              userIsAdmin:userIsAdmin,\n              deleteMember: () => roomOper.deleteMember(vkUserId),\n              deleteRoom: () => roomOper.deleteRoom(roomManager.room.id, returnBack),\n              contextOpened: contextOpened,\n              toggleContext: toggleContext\n        })}\n        <Group>\n          {roomManager.room.channels.map((channel, index) => (\n            <ChannelView\n              key={channel.id}\n              channelIndex={index}\n              channel={channel}\n              renameToChannel={() => showModal(ModalIds.RenameChannel, {\n                renameChannelId: channel.id,\n                renameChannel: roomOper.renameChannel,\n              })}\n              deleteToChannel={() => {roomOper.deleteChannel(channel.id);\n                                      setChannels(roomManager.room.channels)\n                    }}\n              editModeActive={editModeActive}\n              refreshChannel={() => roomOper.refreshChannel(channel.id)}\n              userIsAdmin={userIsAdmin}\n            />\n          ))}\n          {userIsAdmin && (\n            <CellButton\n              onClick={() => showModal(ModalIds.CreateChannel, {\n                createChannel: roomOper.createChannel\n              })\n              }\n              centered\n              before={<Icon24Add />}\n            >\n              {Locales.Channels.CreateChannel}\n            </CellButton>\n          )}\n        </Group>\n        <>\n        {snackbar}\n        </>\n      </Panel>\n    </View>\n  ) : null;\n}\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}