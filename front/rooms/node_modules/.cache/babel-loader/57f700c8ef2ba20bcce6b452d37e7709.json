{"ast":null,"code":"import { _ as _object_spread } from \"@swc/helpers/_/_object_spread\";\nimport * as React from \"react\";\nimport { noop } from \"@vkontakte/vkjs\";\nimport { generateVKUITokensClassName } from \"../../helpers/generateVKUITokensClassName\";\nimport { useAutoDetectAppearance } from \"../../hooks/useAutoDetectAppearance\";\nimport { useObjectMemo } from \"../../hooks/useObjectMemo\";\nimport { useDOM } from \"../../lib/dom\";\nimport { TokensClassProvider } from \"../../lib/tokensClassProvider\";\nimport { useIsomorphicLayoutEffect } from \"../../lib/useIsomorphicLayoutEffect\";\nimport { addClassNameToElement, excludeKeysWithUndefined, removeClassNameFromElement } from \"../../lib/utils\";\nimport { warnOnce } from \"../../lib/warnOnce\";\nimport { ConfigProviderContext, useConfigProvider, WebviewType } from \"./ConfigProviderContext\";\nvar warn = warnOnce(\"ConfigProvider\");\n/**\n * @see https://vkcom.github.io/VKUI/#/ConfigProvider\n */\nexport var ConfigProvider = function (propsRaw) {\n  var props = excludeKeysWithUndefined(propsRaw);\n  var parentConfig = useConfigProvider();\n  var _$_object_spread = _object_spread({}, parentConfig, props),\n    children = _$_object_spread.children,\n    webviewType = _$_object_spread.webviewType,\n    hasCustomPanelHeaderAfterMerged = _$_object_spread.hasCustomPanelHeaderAfter,\n    customPanelHeaderAfterMinWidth = _$_object_spread.customPanelHeaderAfterMinWidth,\n    isWebView = _$_object_spread.isWebView,\n    transitionMotionEnabled = _$_object_spread.transitionMotionEnabled,\n    platform = _$_object_spread.platform,\n    locale = _$_object_spread.locale,\n    appearanceProp = _$_object_spread.appearance,\n    _object_spread_onDetectAppearanceByBridge = _$_object_spread.onDetectAppearanceByBridge,\n    onDetectAppearanceByBridge = _object_spread_onDetectAppearanceByBridge === void 0 ? noop : _object_spread_onDetectAppearanceByBridge;\n  // TODO [>=6]: Удалить данный бэкпорт\n  var hasCustomPanelHeaderAfter = props.webviewType && props.hasCustomPanelHeaderAfter === undefined ? props.webviewType === WebviewType.VKAPPS : hasCustomPanelHeaderAfterMerged;\n  if (process.env.NODE_ENV === \"development\") {\n    // TODO [>=6]: удалить warn\n    var webviewTypeRule = \"\";\n    if (props.webviewType) {\n      webviewTypeRule = props.webviewType === WebviewType.INTERNAL ? \"3. замените webviewType={WebviewType.INTERNAL} на hasCustomPanelHeaderAfterProp={false}\" : \"3. замените webviewType={WebviewType.VKAPPS} на hasCustomPanelHeaderAfterProp={true}\";\n    }\n    warn(\"[@vkontakte/vk-bridge's deprecated] Если вы используете VK Bridge, то:\\n\\n1. используйте хук useAppearance() из @vkontakte/vk-bridge-react и результат передайте в параметр appearance;\\n2. передайте bridge.isWebView() в параметр isWebView;\\n\".concat(webviewTypeRule, \"\\n\\nПодробности см. https://github.com/VKCOM/VKUI/issues/5049\\n\"));\n  }\n  // TODO [>=6]: удалить использование хука\n  var appearance = useAutoDetectAppearance(appearanceProp, onDetectAppearanceByBridge);\n  var document = useDOM().document;\n  // TODO [>=6]: переместить хук в AppRoot (см. https://github.com/VKCOM/VKUI/issues/4810).\n  useIsomorphicLayoutEffect(function attachVKUITokensClassNameToBody() {\n    if (!document) {\n      return;\n    }\n    var VKUITokensClassName = generateVKUITokensClassName(platform, appearance);\n    addClassNameToElement(document.body, VKUITokensClassName);\n    return function () {\n      removeClassNameFromElement(document.body, VKUITokensClassName);\n    };\n  }, [platform, appearance]);\n  var configContext = useObjectMemo({\n    webviewType: webviewType,\n    hasCustomPanelHeaderAfter: hasCustomPanelHeaderAfter,\n    customPanelHeaderAfterMinWidth: customPanelHeaderAfterMinWidth,\n    isWebView: isWebView,\n    transitionMotionEnabled: transitionMotionEnabled,\n    platform: platform,\n    locale: locale,\n    appearance: appearance\n  });\n  return /*#__PURE__*/React.createElement(ConfigProviderContext.Provider, {\n    value: configContext\n  }, /*#__PURE__*/React.createElement(TokensClassProvider, {\n    platform: platform,\n    appearance: appearance\n  }, children));\n};","map":{"version":3,"names":["React","noop","generateVKUITokensClassName","useAutoDetectAppearance","useObjectMemo","useDOM","TokensClassProvider","useIsomorphicLayoutEffect","addClassNameToElement","excludeKeysWithUndefined","removeClassNameFromElement","warnOnce","ConfigProviderContext","useConfigProvider","WebviewType","warn","ConfigProvider","propsRaw","props","parentConfig","_$_object_spread","_object_spread","children","webviewType","hasCustomPanelHeaderAfterMerged","hasCustomPanelHeaderAfter","customPanelHeaderAfterMinWidth","isWebView","transitionMotionEnabled","platform","locale","appearanceProp","appearance","_object_spread_onDetectAppearanceByBridge","onDetectAppearanceByBridge","undefined","VKAPPS","process","env","NODE_ENV","webviewTypeRule","INTERNAL","concat","document","attachVKUITokensClassNameToBody","VKUITokensClassName","body","configContext","createElement","Provider","value"],"sources":["../../../src/components/ConfigProvider/ConfigProvider.tsx"],"sourcesContent":["import * as React from 'react';\nimport { noop } from '@vkontakte/vkjs';\nimport { generateVKUITokensClassName } from '../../helpers/generateVKUITokensClassName';\nimport { useAutoDetectAppearance } from '../../hooks/useAutoDetectAppearance';\nimport { useObjectMemo } from '../../hooks/useObjectMemo';\nimport { useDOM } from '../../lib/dom';\nimport { TokensClassProvider } from '../../lib/tokensClassProvider';\nimport { useIsomorphicLayoutEffect } from '../../lib/useIsomorphicLayoutEffect';\nimport {\n  addClassNameToElement,\n  excludeKeysWithUndefined,\n  removeClassNameFromElement,\n} from '../../lib/utils';\nimport { warnOnce } from '../../lib/warnOnce';\nimport {\n  ConfigProviderContext,\n  ConfigProviderContextInterface,\n  useConfigProvider,\n  WebviewType,\n} from './ConfigProviderContext';\n\nconst warn = warnOnce('ConfigProvider');\n\nexport interface ConfigProviderProps extends Partial<ConfigProviderContextInterface> {\n  /**\n   * > ⚠️ В **v6** метод будет удалён (см. https://github.com/VKCOM/VKUI/issues/5049).\n   * > Используйте хук `useAppearance()` из библиотеки `@vkontakte/vk-bridge-react`, если вам нужно\n   * > определять, что `appearance` был передан через VK Bridge.\n   *\n   * @deprecated v5.8.0\n   */\n  onDetectAppearanceByBridge?: () => void; // TODO [>=6]: удалить\n  children: React.ReactNode;\n}\n\n/**\n * @see https://vkcom.github.io/VKUI/#/ConfigProvider\n */\nexport const ConfigProvider = (propsRaw: ConfigProviderProps) => {\n  const props = excludeKeysWithUndefined(propsRaw);\n  const parentConfig = useConfigProvider();\n\n  const {\n    children,\n    webviewType,\n    hasCustomPanelHeaderAfter: hasCustomPanelHeaderAfterMerged,\n    customPanelHeaderAfterMinWidth,\n    isWebView,\n    transitionMotionEnabled,\n    platform,\n    locale,\n    appearance: appearanceProp,\n    onDetectAppearanceByBridge = noop,\n  } = {\n    ...parentConfig,\n    ...props,\n  };\n\n  // TODO [>=6]: Удалить данный бэкпорт\n  const hasCustomPanelHeaderAfter =\n    props.webviewType && props.hasCustomPanelHeaderAfter === undefined\n      ? props.webviewType === WebviewType.VKAPPS\n      : hasCustomPanelHeaderAfterMerged;\n\n  if (process.env.NODE_ENV === 'development') {\n    // TODO [>=6]: удалить warn\n    let webviewTypeRule = '';\n    if (props.webviewType) {\n      webviewTypeRule =\n        props.webviewType === WebviewType.INTERNAL\n          ? '3. замените webviewType={WebviewType.INTERNAL} на hasCustomPanelHeaderAfterProp={false}'\n          : '3. замените webviewType={WebviewType.VKAPPS} на hasCustomPanelHeaderAfterProp={true}';\n    }\n    warn(`[@vkontakte/vk-bridge's deprecated] Если вы используете VK Bridge, то:\n\n1. используйте хук useAppearance() из @vkontakte/vk-bridge-react и результат передайте в параметр appearance;\n2. передайте bridge.isWebView() в параметр isWebView;\n${webviewTypeRule}\n\nПодробности см. https://github.com/VKCOM/VKUI/issues/5049\n`);\n  }\n\n  // TODO [>=6]: удалить использование хука\n  const appearance = useAutoDetectAppearance(appearanceProp, onDetectAppearanceByBridge);\n\n  const { document } = useDOM();\n\n  // TODO [>=6]: переместить хук в AppRoot (см. https://github.com/VKCOM/VKUI/issues/4810).\n  useIsomorphicLayoutEffect(\n    function attachVKUITokensClassNameToBody() {\n      if (!document) {\n        return;\n      }\n\n      const VKUITokensClassName = generateVKUITokensClassName(platform, appearance);\n\n      addClassNameToElement(document.body, VKUITokensClassName);\n      return () => {\n        removeClassNameFromElement(document.body, VKUITokensClassName);\n      };\n    },\n    [platform, appearance],\n  );\n\n  const configContext = useObjectMemo({\n    webviewType,\n    hasCustomPanelHeaderAfter,\n    customPanelHeaderAfterMinWidth,\n    isWebView,\n    transitionMotionEnabled,\n    platform,\n    locale,\n    appearance,\n  });\n\n  return (\n    <ConfigProviderContext.Provider value={configContext}>\n      <TokensClassProvider platform={platform} appearance={appearance}>\n        {children}\n      </TokensClassProvider>\n    </ConfigProviderContext.Provider>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}