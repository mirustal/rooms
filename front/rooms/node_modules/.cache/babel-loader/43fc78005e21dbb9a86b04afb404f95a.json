{"ast":null,"code":"import { _ as _define_property } from \"@swc/helpers/_/_define_property\";\nimport { _ as _object_spread } from \"@swc/helpers/_/_object_spread\";\nimport { _ as _object_spread_props } from \"@swc/helpers/_/_object_spread_props\";\nimport * as React from \"react\";\nimport { useIsomorphicLayoutEffect } from \"../../lib/useIsomorphicLayoutEffect\";\nexport var ModalRootContext = /*#__PURE__*/React.createContext({\n  updateModalHeight: function () {\n    return undefined;\n  },\n  registerModal: function () {\n    return undefined;\n  },\n  isInsideModal: false\n});\n/**\n * All referenced elements must be static\n */\nexport function useModalRegistry(id, type) {\n  var modalContext = React.useContext(ModalRootContext);\n  var elements = React.useRef({}).current;\n  useIsomorphicLayoutEffect(function () {\n    if (id !== undefined) {\n      modalContext.registerModal(_object_spread_props(_object_spread({}, elements), {\n        type: type,\n        id: id\n      }));\n      // unset refs on  unmount to prevent leak\n      var reset = Object.keys(elements).reduce(function (acc, k) {\n        return _object_spread_props(_object_spread({}, acc), _define_property({}, k, null));\n      }, {\n        type: type,\n        id: id\n      });\n      return function () {\n        return modalContext.registerModal(reset);\n      };\n    }\n    return undefined;\n  }, []);\n  var refs = React.useRef({\n    modalElement: function (e) {\n      return elements.modalElement = e;\n    },\n    innerElement: function (e) {\n      return elements.innerElement = e;\n    },\n    headerElement: function (e) {\n      return elements.headerElement = e;\n    },\n    contentElement: function (e) {\n      return elements.contentElement = e;\n    },\n    bottomInset: function (e) {\n      return elements.bottomInset = e;\n    }\n  }).current;\n  return {\n    refs: refs\n  };\n}","map":{"version":3,"names":["React","useIsomorphicLayoutEffect","ModalRootContext","createContext","updateModalHeight","undefined","registerModal","isInsideModal","useModalRegistry","id","type","modalContext","useContext","elements","useRef","current","_object_spread_props","_object_spread","reset","Object","keys","reduce","acc","k","_define_property","refs","modalElement","e","innerElement","headerElement","contentElement","bottomInset"],"sources":["../../../src/components/ModalRoot/ModalRootContext.tsx"],"sourcesContent":["import * as React from 'react';\nimport { useIsomorphicLayoutEffect } from '../../lib/useIsomorphicLayoutEffect';\nimport { ModalElements, ModalsStateEntry, ModalType } from './types';\n\nexport type ModalRegistryEntry = ModalElements & Required<Pick<ModalsStateEntry, 'type' | 'id'>>;\ntype ModalRefs = { [k in keyof ModalElements]: (e: ModalElements[k]) => void };\n\nexport interface ModalRootContextInterface {\n  updateModalHeight: VoidFunction;\n  registerModal(data: ModalRegistryEntry): void;\n  onClose?: VoidFunction;\n  isInsideModal: boolean;\n}\n\nexport const ModalRootContext = React.createContext<ModalRootContextInterface>({\n  updateModalHeight: () => undefined,\n  registerModal: () => undefined,\n  isInsideModal: false,\n});\n\n/**\n * All referenced elements must be static\n */\nexport function useModalRegistry(id: string | undefined, type: ModalType) {\n  const modalContext = React.useContext(ModalRootContext);\n  const elements = React.useRef<ModalElements>({}).current;\n  useIsomorphicLayoutEffect(() => {\n    if (id !== undefined) {\n      modalContext.registerModal({ ...elements, type, id });\n      // unset refs on  unmount to prevent leak\n      const reset = Object.keys(elements).reduce<ModalRegistryEntry>(\n        (acc, k) => ({ ...acc, [k]: null }),\n        { type, id },\n      );\n      return () => modalContext.registerModal(reset);\n    }\n    return undefined;\n  }, []);\n\n  const refs = React.useRef<Required<ModalRefs>>({\n    modalElement: (e) => (elements.modalElement = e),\n    innerElement: (e) => (elements.innerElement = e),\n    headerElement: (e) => (elements.headerElement = e),\n    contentElement: (e) => (elements.contentElement = e),\n    bottomInset: (e) => (elements.bottomInset = e),\n  }).current;\n  return { refs };\n}\n"],"mappings":";;;AAAA,YAAYA,KAAA,MAAW;AACvB,SAASC,yBAAyB,QAAQ;AAa1C,OAAO,IAAMC,gBAAA,gBAAmBF,KAAA,CAAMG,aAAa,CAA4B;EAC7EC,iBAAA,EAAmB,SAAAA,CAAA;WAAMC,SAAA;;EACzBC,aAAA,EAAe,SAAAA,CAAA;WAAMD,SAAA;;EACrBE,aAAA,EAAe;AACjB;AAEA;;;AAGA,OAAO,SAASC,iBAAiBC,EAAsB,EAAEC,IAAe;EACtE,IAAMC,YAAA,GAAeX,KAAA,CAAMY,UAAU,CAACV,gBAAA;EACtC,IAAMW,QAAA,GAAWb,KAAA,CAAMc,MAAM,CAAgB,CAAC,GAAGC,OAAO;EACxDd,yBAAA,CAA0B;IACxB,IAAIQ,EAAA,KAAOJ,SAAA,EAAW;MACpBM,YAAA,CAAaL,aAAa,CAACU,oBAAA,CAAAC,cAAA,KAAKJ,QAAA;QAAUH,IAAA,EAAAA,IAAA;QAAMD,EAAA,EAAAA;;MAChD;MACA,IAAMS,KAAA,GAAQC,MAAA,CAAOC,IAAI,CAACP,QAAA,EAAUQ,MAAM,CACxC,UAACC,GAAA,EAAKC,CAAA;eAAOP,oBAAA,CAAAC,cAAA,KAAKK,GAAA,GAAKE,gBAAA,KAACD,CAAA,EAAI;SAC5B;QAAEb,IAAA,EAAAA,IAAA;QAAMD,EAAA,EAAAA;MAAG;MAEb,OAAO;eAAME,YAAA,CAAaL,aAAa,CAACY,KAAA;;IAC1C;IACA,OAAOb,SAAA;EACT,GAAG,EAAE;EAEL,IAAMoB,IAAA,GAAOzB,KAAA,CAAMc,MAAM,CAAsB;IAC7CY,YAAA,EAAc,SAAAA,CAACC,CAAA;aAAOd,QAAA,CAASa,YAAY,GAAGC,CAAA;;IAC9CC,YAAA,EAAc,SAAAA,CAACD,CAAA;aAAOd,QAAA,CAASe,YAAY,GAAGD,CAAA;;IAC9CE,aAAA,EAAe,SAAAA,CAACF,CAAA;aAAOd,QAAA,CAASgB,aAAa,GAAGF,CAAA;;IAChDG,cAAA,EAAgB,SAAAA,CAACH,CAAA;aAAOd,QAAA,CAASiB,cAAc,GAAGH,CAAA;;IAClDI,WAAA,EAAa,SAAAA,CAACJ,CAAA;aAAOd,QAAA,CAASkB,WAAW,GAAGJ,CAAA;;EAC9C,GAAGZ,OAAO;EACV,OAAO;IAAEU,IAAA,EAAAA;EAAK;AAChB"},"metadata":{},"sourceType":"module"}