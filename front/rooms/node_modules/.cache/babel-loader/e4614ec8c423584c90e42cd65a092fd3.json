{"ast":null,"code":"import { _ as _object_spread } from \"@swc/helpers/_/_object_spread\";\nimport { _ as _object_spread_props } from \"@swc/helpers/_/_object_spread_props\";\nimport { _ as _object_without_properties } from \"@swc/helpers/_/_object_without_properties\";\nimport { _ as _sliced_to_array } from \"@swc/helpers/_/_sliced_to_array\";\nimport * as React from \"react\";\nimport { classNames } from \"@vkontakte/vkjs\";\nimport { useExternRef } from \"../../hooks/useExternRef\";\nimport { useGlobalEventListener } from \"../../hooks/useGlobalEventListener\";\nimport { usePlatform } from \"../../hooks/usePlatform\";\nimport { useDOM } from \"../../lib/dom\";\nimport { Platform } from \"../../lib/platform\";\nimport { SplitColContext } from \"../SplitCol/SplitColContext\";\nimport { TooltipContainer } from \"../Tooltip/TooltipContainer\";\nvar stylesVertical = {\n  top: \"vkuiFixedLayout--vertical-top\",\n  bottom: classNames(\"vkuiFixedLayout--vertical-bottom\", \"vkuiInternalFixedLayout--vertical-bottom\")\n};\n/**\n * @see https://vkcom.github.io/VKUI/#/FixedLayout\n */\nexport var FixedLayout = function (_param) {\n  var children = _param.children,\n    style = _param.style,\n    vertical = _param.vertical,\n    getRootRef = _param.getRootRef,\n    getRef = _param.getRef,\n    filled = _param.filled,\n    className = _param.className,\n    useParentWidth = _param.useParentWidth,\n    restProps = _object_without_properties(_param, [\"children\", \"style\", \"vertical\", \"getRootRef\", \"getRef\", \"filled\", \"className\", \"useParentWidth\"]);\n  var platform = usePlatform();\n  var ref = useExternRef(getRootRef, getRef); // TODO [>=6]: удалить getRef\n  var _React_useState = _sliced_to_array(React.useState(undefined), 2),\n    width = _React_useState[0],\n    setWidth = _React_useState[1];\n  var window = useDOM().window;\n  var colRef = React.useContext(SplitColContext).colRef;\n  var doResize = function () {\n    if (useParentWidth && ref.current) {\n      var _ref_current_parentElement;\n      var parentWidth = (_ref_current_parentElement = ref.current.parentElement) === null || _ref_current_parentElement === void 0 ? void 0 : _ref_current_parentElement.getBoundingClientRect().width;\n      setWidth(parentWidth ? \"\".concat(parentWidth, \"px\") : undefined);\n    } else if (colRef === null || colRef === void 0 ? void 0 : colRef.current) {\n      var computedStyle = getComputedStyle(colRef.current);\n      setWidth(\"\".concat(colRef.current.clientWidth - parseFloat(computedStyle.paddingLeft) - parseFloat(computedStyle.paddingRight), \"px\"));\n    } else {\n      setWidth(undefined);\n    }\n  };\n  React.useEffect(doResize, [colRef, platform, ref, useParentWidth]);\n  useGlobalEventListener(window, \"resize\", doResize);\n  return /*#__PURE__*/React.createElement(TooltipContainer, _object_spread_props(_object_spread({}, restProps), {\n    fixed: true,\n    ref: ref,\n    className: classNames(\"vkuiFixedLayout\", platform === Platform.IOS && \"vkuiInternalFixedLayout--ios\", filled && \"vkuiFixedLayout--filled\", vertical && stylesVertical[vertical], className),\n    style: _object_spread_props(_object_spread({}, style), {\n      width: width\n    })\n  }), children);\n};","map":{"version":3,"names":["React","classNames","useExternRef","useGlobalEventListener","usePlatform","useDOM","Platform","SplitColContext","TooltipContainer","stylesVertical","top","bottom","FixedLayout","_param","children","style","vertical","getRootRef","getRef","filled","className","useParentWidth","restProps","_object_without_properties","platform","ref","_React_useState","_sliced_to_array","useState","undefined","width","setWidth","window","colRef","useContext","doResize","current","_ref_current_parentElement","parentWidth","parentElement","getBoundingClientRect","concat","computedStyle","getComputedStyle","clientWidth","parseFloat","paddingLeft","paddingRight","useEffect","createElement","_object_spread_props","_object_spread","fixed","IOS"],"sources":["../../../src/components/FixedLayout/FixedLayout.tsx"],"sourcesContent":["import * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport { useExternRef } from '../../hooks/useExternRef';\nimport { useGlobalEventListener } from '../../hooks/useGlobalEventListener';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport { useDOM } from '../../lib/dom';\nimport { Platform } from '../../lib/platform';\nimport { HasRef, HTMLAttributesWithRootRef } from '../../types';\nimport { SplitColContext } from '../SplitCol/SplitColContext';\nimport { TooltipContainer } from '../Tooltip/TooltipContainer';\nimport styles from './FixedLayout.module.css';\n\nconst stylesVertical = {\n  top: styles['FixedLayout--vertical-top'],\n  bottom: classNames(\n    styles['FixedLayout--vertical-bottom'],\n    'vkuiInternalFixedLayout--vertical-bottom',\n  ),\n};\n\nexport interface FixedLayoutProps\n  extends HTMLAttributesWithRootRef<HTMLDivElement>,\n    HasRef<HTMLDivElement> {\n  vertical?: 'top' | 'bottom';\n  /**\n   * Это свойство определяет, будет ли фон компонента окрашен в цвет фона контента.\n   * Это часто необходимо для фиксированных кнопок в нижней части экрана.\n   */\n  filled?: boolean;\n  /**\n   * Всегда соответствовать ширине родителя.\n   * Ширина пересчитывается по событию `window` `resize`.\n   */\n  useParentWidth?: boolean;\n}\n\nexport interface FixedLayoutState {\n  position: 'absolute' | null;\n  top: number;\n  bottom: number;\n  width: string;\n}\n\n/**\n * @see https://vkcom.github.io/VKUI/#/FixedLayout\n */\nexport const FixedLayout = ({\n  children,\n  style,\n  vertical,\n  getRootRef,\n  getRef,\n  filled,\n  className,\n  useParentWidth,\n  ...restProps\n}: FixedLayoutProps) => {\n  const platform = usePlatform();\n  const ref = useExternRef(getRootRef, getRef); // TODO [>=6]: удалить getRef\n  const [width, setWidth] = React.useState<string | undefined>(undefined);\n  const { window } = useDOM();\n  const { colRef } = React.useContext(SplitColContext);\n\n  const doResize = () => {\n    if (useParentWidth && ref.current) {\n      const parentWidth = ref.current.parentElement?.getBoundingClientRect().width;\n      setWidth(parentWidth ? `${parentWidth}px` : undefined);\n    } else if (colRef?.current) {\n      const computedStyle = getComputedStyle(colRef.current);\n\n      setWidth(\n        `${\n          colRef.current.clientWidth -\n          parseFloat(computedStyle.paddingLeft) -\n          parseFloat(computedStyle.paddingRight)\n        }px`,\n      );\n    } else {\n      setWidth(undefined);\n    }\n  };\n  React.useEffect(doResize, [colRef, platform, ref, useParentWidth]);\n  useGlobalEventListener(window, 'resize', doResize);\n\n  return (\n    <TooltipContainer\n      {...restProps}\n      fixed\n      ref={ref}\n      className={classNames(\n        styles['FixedLayout'],\n        platform === Platform.IOS && 'vkuiInternalFixedLayout--ios',\n        filled && styles['FixedLayout--filled'],\n        vertical && stylesVertical[vertical],\n        className,\n      )}\n      style={{ ...style, width }}\n    >\n      {children}\n    </TooltipContainer>\n  );\n};\n"],"mappings":";;;;AAAA,YAAYA,KAAA,MAAW;AACvB,SAASC,UAAU,QAAQ;AAC3B,SAASC,YAAY,QAAQ;AAC7B,SAASC,sBAAsB,QAAQ;AACvC,SAASC,WAAW,QAAQ;AAC5B,SAASC,MAAM,QAAQ;AACvB,SAASC,QAAQ,QAAQ;AAEzB,SAASC,eAAe,QAAQ;AAChC,SAASC,gBAAgB,QAAQ;AAGjC,IAAMC,cAAA,GAAiB;EACrBC,GAAG;EACHC,MAAA,EAAQV,UAAA,qCAEN;AAEJ;AAyBA;;;AAGA,OAAO,IAAMW,WAAA,GAAc,SAAAA,CAAAC,MAAA;MACzBC,QAAA,GAAAD,MAAA,CAAAC,QAAA;IACAC,KAAA,GAAAF,MAAA,CAAAE,KAAA;IACAC,QAAA,GAAAH,MAAA,CAAAG,QAAA;IACAC,UAAA,GAAAJ,MAAA,CAAAI,UAAA;IACAC,MAAA,GAAAL,MAAA,CAAAK,MAAA;IACAC,MAAA,GAAAN,MAAA,CAAAM,MAAA;IACAC,SAAA,GAAAP,MAAA,CAAAO,SAAA;IACAC,cAAA,GAAAR,MAAA,CAAAQ,cAAA;IACGC,SAAA,GAAAC,0BAAA,CAAAV,MAAA,GARH,YACA,SACA,YACA,cACA,UACA,UACA,aACA,iB;EAGA,IAAMW,QAAA,GAAWpB,WAAA;EACjB,IAAMqB,GAAA,GAAMvB,YAAA,CAAae,UAAA,EAAYC,MAAA,GAAS;EAC9C,IAA0BQ,eAAA,GAAAC,gBAAA,CAAA3B,KAAA,CAAM4B,QAAQ,CAAqBC,SAAA;IAAtDC,KAAA,GAAmBJ,eAAA;IAAZK,QAAA,GAAYL,eAAA;EAC1B,IAAMM,MAAE,GAAW3B,MAAA,GAAX2B,MAAA;EACR,IAAMC,MAAE,GAAWjC,KAAA,CAAMkC,UAAU,CAAC3B,eAAA,EAA5B0B,MAAA;EAER,IAAME,QAAA,GAAW,SAAAA,CAAA;IACf,IAAId,cAAA,IAAkBI,GAAA,CAAIW,OAAO,EAAE;UACbC,0BAAA;MAApB,IAAMC,WAAA,IAAcD,0BAAA,GAAAZ,GAAA,CAAIW,OAAO,CAACG,aAAa,cAAzBF,0BAAA,uBAAAA,0BAAA,CAA2BG,qBAAqB,GAAGV,KAAK;MAC5EC,QAAA,CAASO,WAAA,GAAc,EAAC,CAAcG,MAAA,CAAZH,WAAA,EAAY,QAAMT,SAAA;IAC9C,OAAO,IAAII,MAAA,aAAAA,MAAA,uBAAAA,MAAA,CAAQG,OAAO,EAAE;MAC1B,IAAMM,aAAA,GAAgBC,gBAAA,CAAiBV,MAAA,CAAOG,OAAO;MAErDL,QAAA,CACE,EAAC,CAIAU,MAAA,CAHCR,MAAA,CAAOG,OAAO,CAACQ,WAAW,GAC1BC,UAAA,CAAWH,aAAA,CAAcI,WAAW,IACpCD,UAAA,CAAWH,aAAA,CAAcK,YAAY,GACtC;IAEL,OAAO;MACLhB,QAAA,CAASF,SAAA;IACX;EACF;EACA7B,KAAA,CAAMgD,SAAS,CAACb,QAAA,EAAU,CAACF,MAAA,EAAQT,QAAA,EAAUC,GAAA,EAAKJ,cAAA,CAAe;EACjElB,sBAAA,CAAuB6B,MAAA,EAAQ,UAAUG,QAAA;EAEzC,oBACEnC,KAAA,CAAAiD,aAAA,CAACzC,gBAAA,EAAA0C,oBAAA,CAAAC,cAAA,KACK7B,SAAA;IACJ8B,KAAA;IACA3B,GAAA,EAAKA,GAAA;IACLL,SAAA,EAAWnB,UAAA,oBAETuB,QAAA,KAAalB,QAAA,CAAS+C,GAAG,IAAI,gCAC7BlC,MAAA,+BACAH,QAAA,IAAYP,cAAc,CAACO,QAAA,CAAS,EACpCI,SAAA;IAEFL,KAAA,EAAOmC,oBAAA,CAAAC,cAAA,KAAKpC,KAAA;MAAOe,KAAA,EAAAA;;MAElBhB,QAAA;AAGP"},"metadata":{},"sourceType":"module"}