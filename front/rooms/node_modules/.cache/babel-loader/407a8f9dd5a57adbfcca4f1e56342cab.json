{"ast":null,"code":"import _slicedToArray from\"/Users/mirustal/Documents/project/rooms/front/rooms/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useState}from\"react\";import{View,Panel,Group,PanelHeader,PanelHeaderBack,CellButton,Div,PanelHeaderContent,PanelHeaderButton}from\"@vkontakte/vkui\";import{ModalIds,Views}from\"../../../model/views\";import ChannelView from\"./ChannelView\";import{Icon16Dropdown,Icon24Add,Icon28AddOutline}from\"@vkontakte/icons\";import AlterActionSheet from\"./AlterActionSheet\";import{AlertManagerContext}from\"../../contexts/AlertProvider\";import useAdminStatus from\"./hooks/AdminStatus\";import{ModalManager}from\"../../Modals\";import{Locales}from\"../../../locales/locales\";import{roomOperation}from\"./utils/roomOperation\";import{openBaseWithAction}from\"../../Snackbar\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Channels(_ref){var roomManager=_ref.roomManager,_returnBack=_ref.returnBack;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),editModeActive=_useState2[0],setEditModeActive=_useState2[1];var userIsAdmin=useAdminStatus(roomManager.room);var alerts=useContext(AlertManagerContext);var roomOper=roomOperation(roomManager,alerts);var _useState3=useState(roomManager.channels),_useState4=_slicedToArray(_useState3,2),channels=_useState4[0],setChannels=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),snackbar=_useState6[0],setSnackbar=_useState6[1];var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),contextOpened=_React$useState2[0],setContextOpened=_React$useState2[1];var toggleContext=function toggleContext(){setContextOpened(function(prev){return!prev;});};var toggleEditMode=function toggleEditMode(){setEditModeActive(!editModeActive);openBaseWithAction(snackbar,setSnackbar,editModeActive);};var showModal=function showModal(modalId,props){ModalManager.showModal(modalId,props);};return roomManager.room?/*#__PURE__*/_jsx(View,{id:Views.Rooms.id,activePanel:Views.Rooms.panels.list.id,children:/*#__PURE__*/_jsxs(Panel,{id:Views.Rooms.panels.list.id,children:[/*#__PURE__*/_jsx(PanelHeader,{before:/*#__PURE__*/_jsx(PanelHeaderBack,{onClick:_returnBack}),after:/*#__PURE__*/_jsx(PanelHeaderButton,{children:/*#__PURE__*/_jsx(Icon28AddOutline,{})}),children:/*#__PURE__*/_jsx(PanelHeaderContent,{aside:/*#__PURE__*/_jsx(Icon16Dropdown,{style:{transform:\"rotate(\".concat(contextOpened?'180deg':'0',\")\")}}),onClick:toggleContext,children:roomManager.room.name})}),AlterActionSheet({roomInfo:roomManager.room,returnBack:function returnBack(){return _returnBack;},handleActiveEditMode:toggleEditMode,userIsAdmin:userIsAdmin,deleteRoom:function deleteRoom(){return roomOper.deleteRoom(roomManager.room.id,_returnBack);},contextOpened:contextOpened,toggleContext:toggleContext}),/*#__PURE__*/_jsxs(Group,{children:[roomManager.room.channels.map(function(channel,index){return/*#__PURE__*/_jsx(ChannelView,{channelIndex:index,channel:channel,renameToChannel:function renameToChannel(){return showModal(ModalIds.RenameChannel,{renameChannelId:channel.id,renameChannel:roomOper.renameChannel});},deleteToChannel:function deleteToChannel(){roomOper.deleteChannel(channel.id);setChannels(roomManager.room.channels);},editModeActive:editModeActive,refreshChannel:function refreshChannel(){return roomOper.refreshChannel(channel.id);},userIsAdmin:userIsAdmin},channel.id);}),userIsAdmin&&/*#__PURE__*/_jsx(CellButton,{onClick:function onClick(){return showModal(ModalIds.CreateChannel,{createChannel:roomOper.createChannel});},centered:true,before:/*#__PURE__*/_jsx(Icon24Add,{}),children:Locales.Channels.CreateChannel})]}),/*#__PURE__*/_jsx(_Fragment,{children:snackbar})]})}):null;}","map":{"version":3,"names":["React","useContext","useState","View","Panel","Group","PanelHeader","PanelHeaderBack","CellButton","Div","PanelHeaderContent","PanelHeaderButton","ModalIds","Views","ChannelView","Icon16Dropdown","Icon24Add","Icon28AddOutline","AlterActionSheet","AlertManagerContext","useAdminStatus","ModalManager","Locales","roomOperation","openBaseWithAction","Channels","roomManager","returnBack","editModeActive","setEditModeActive","userIsAdmin","room","alerts","roomOper","channels","setChannels","snackbar","setSnackbar","contextOpened","setContextOpened","toggleContext","prev","toggleEditMode","showModal","modalId","props","Rooms","id","panels","list","transform","name","roomInfo","handleActiveEditMode","deleteRoom","map","channel","index","RenameChannel","renameChannelId","renameChannel","deleteChannel","refreshChannel","CreateChannel","createChannel"],"sources":["/Users/mirustal/Documents/project/rooms/front/rooms/src/components/views/Channels/Channels.jsx"],"sourcesContent":["import React, { useContext, useState } from \"react\";\nimport {\n  View,\n  Panel,\n  Group,\n  PanelHeader,\n  PanelHeaderBack,\n  CellButton,\n  Div,\n  PanelHeaderContent,\n  PanelHeaderButton,\n} from \"@vkontakte/vkui\";\nimport { ModalIds, Views } from \"../../../model/views\";\nimport ChannelView from \"./ChannelView\";\nimport { Icon16Dropdown, Icon24Add, Icon28AddOutline } from \"@vkontakte/icons\";\nimport AlterActionSheet from \"./AlterActionSheet\";\nimport { AlertManagerContext } from \"../../contexts/AlertProvider\";\nimport useAdminStatus from \"./hooks/AdminStatus\";\nimport { ModalManager } from \"../../Modals\";\nimport { Locales } from \"../../../locales/locales\";\nimport { roomOperation } from \"./utils/roomOperation\";\nimport { openBaseWithAction } from \"../../Snackbar\";\n\nexport default function Channels({ roomManager, returnBack }) {\n  const [editModeActive, setEditModeActive] = useState(false);\n  const userIsAdmin = useAdminStatus(roomManager.room);\n  const alerts = useContext(AlertManagerContext);\n  const roomOper = roomOperation(roomManager, alerts);\n  const [channels, setChannels] = useState(roomManager.channels)\n  const [snackbar, setSnackbar] = useState(null)\n  \n  const [contextOpened, setContextOpened] = React.useState(false);\n  const toggleContext = () => {\n    setContextOpened((prev) => !prev);\n  };\n\n\n\n  const toggleEditMode = () => {\n    setEditModeActive(!editModeActive);\n    openBaseWithAction(snackbar, setSnackbar, editModeActive);\n  }\n\n  const showModal = (modalId, props) => {\n    ModalManager.showModal(modalId, props);\n  };\n\n  return roomManager.room ? (\n    <View id={Views.Rooms.id} activePanel={Views.Rooms.panels.list.id}>\n      <Panel id={Views.Rooms.panels.list.id}>\n        <PanelHeader before={<PanelHeaderBack onClick={returnBack} />} after={\n                <PanelHeaderButton>\n                  <Icon28AddOutline />\n                </PanelHeaderButton>\n              }>\n            <PanelHeaderContent\n              aside={\n                <Icon16Dropdown\n                  style={{\n                    transform: `rotate(${contextOpened ? '180deg' : '0'})`,\n                  }}\n                />\n              }\n              onClick={toggleContext}\n            >\n              {roomManager.room.name}\n            </PanelHeaderContent>\n        </PanelHeader>\n        {AlterActionSheet({\n              roomInfo:roomManager.room,\n              returnBack:() => returnBack,\n              handleActiveEditMode: toggleEditMode,\n              userIsAdmin:userIsAdmin,\n              deleteRoom: () => roomOper.deleteRoom(roomManager.room.id, returnBack),\n              contextOpened: contextOpened,\n              toggleContext: toggleContext\n        })}\n        <Group>\n          {roomManager.room.channels.map((channel, index) => (\n            <ChannelView\n              key={channel.id}\n              channelIndex={index}\n              channel={channel}\n              renameToChannel={() => showModal(ModalIds.RenameChannel, {\n                renameChannelId: channel.id,\n                renameChannel: roomOper.renameChannel,\n              })}\n              deleteToChannel={() => {roomOper.deleteChannel(channel.id);\n                                      setChannels(roomManager.room.channels)\n                    }}\n              editModeActive={editModeActive}\n              refreshChannel={() => roomOper.refreshChannel(channel.id)}\n              userIsAdmin={userIsAdmin}\n            />\n          ))}\n          {userIsAdmin && (\n            <CellButton\n              onClick={() => showModal(ModalIds.CreateChannel, {\n                createChannel: roomOper.createChannel\n              })\n              }\n              centered\n              before={<Icon24Add />}\n            >\n              {Locales.Channels.CreateChannel}\n            </CellButton>\n          )}\n        </Group>\n        <>\n        {snackbar}\n        </>\n      </Panel>\n    </View>\n  ) : null;\n}\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}