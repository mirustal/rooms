{"ast":null,"code":"import { _ as _object_spread } from \"@swc/helpers/_/_object_spread\";\nimport { _ as _object_spread_props } from \"@swc/helpers/_/_object_spread_props\";\nimport { _ as _object_without_properties } from \"@swc/helpers/_/_object_without_properties\";\nimport { _ as _sliced_to_array } from \"@swc/helpers/_/_sliced_to_array\";\nimport * as React from \"react\";\nimport { classNames } from \"@vkontakte/vkjs\";\nimport { useAdaptivityHasPointer } from \"../../../hooks/useAdaptivityHasPointer\";\nimport { useExternRef } from \"../../../hooks/useExternRef\";\nimport { useGlobalEventListener } from \"../../../hooks/useGlobalEventListener\";\nimport { useDOM } from \"../../../lib/dom\";\nimport { useIsomorphicLayoutEffect } from \"../../../lib/useIsomorphicLayoutEffect\";\nimport { warnOnce } from \"../../../lib/warnOnce\";\nimport { RootComponent } from \"../../RootComponent/RootComponent\";\nimport { ScrollArrow } from \"../../ScrollArrow/ScrollArrow\";\nimport { Touch } from \"../../Touch/Touch\";\nimport { ANIMATION_DURATION, CONTROL_ELEMENTS_STATE, SLIDES_MANAGER_STATE } from \"./constants\";\nimport { calculateIndent, getLoopPoints, getTargetIndex } from \"./helpers\";\nimport { useSlideAnimation } from \"./hooks\";\nvar stylesBullets = {\n  dark: \"vkuiBaseGallery__bullets--dark\",\n  light: \"vkuiBaseGallery__bullets--light\"\n};\nvar warn = warnOnce(\"Gallery\");\nexport var CarouselBase = function (_param) {\n  var _param_bullets = _param.bullets,\n    bullets = _param_bullets === void 0 ? false : _param_bullets,\n    getRootRef = _param.getRootRef,\n    children = _param.children,\n    _param_slideWidth = _param.slideWidth,\n    slideWidth = _param_slideWidth === void 0 ? \"100%\" : _param_slideWidth,\n    _param_slideIndex = _param.slideIndex,\n    slideIndex = _param_slideIndex === void 0 ? 0 : _param_slideIndex,\n    tmp = _param.isDraggable,\n    isDraggableProp = tmp === void 0 ? true : tmp,\n    onDragStart = _param.onDragStart,\n    onDragEnd = _param.onDragEnd,\n    onChange = _param.onChange,\n    onPrevClick = _param.onPrevClick,\n    onNextClick = _param.onNextClick,\n    _param_align = _param.align,\n    align = _param_align === void 0 ? \"left\" : _param_align,\n    showArrows = _param.showArrows,\n    getRef = _param.getRef,\n    _param_arrowSize = _param.arrowSize,\n    arrowSize = _param_arrowSize === void 0 ? \"l\" : _param_arrowSize,\n    restProps = _object_without_properties(_param, [\"bullets\", \"getRootRef\", \"children\", \"slideWidth\", \"slideIndex\", \"isDraggable\", \"onDragStart\", \"onDragEnd\", \"onChange\", \"onPrevClick\", \"onNextClick\", \"align\", \"showArrows\", \"getRef\", \"arrowSize\"]);\n  var slidesStore = React.useRef({});\n  var slidesManager = React.useRef(SLIDES_MANAGER_STATE);\n  var rootRef = useExternRef(getRootRef);\n  var viewportRef = useExternRef(getRef);\n  var layerRef = React.useRef(null);\n  var animationFrameRef = React.useRef(null);\n  var shiftXCurrentRef = React.useRef(0);\n  var shiftXDeltaRef = React.useRef(0);\n  var initialized = React.useRef(false);\n  var _useSlideAnimation = useSlideAnimation(),\n    addToAnimationQueue = _useSlideAnimation.addToAnimationQueue,\n    getAnimateFunction = _useSlideAnimation.getAnimateFunction,\n    startAnimation = _useSlideAnimation.startAnimation;\n  var _React_useState = _sliced_to_array(React.useState(CONTROL_ELEMENTS_STATE), 2),\n    controlElementsState = _React_useState[0],\n    setControlElementsState = _React_useState[1];\n  var window = useDOM().window;\n  var hasPointer = useAdaptivityHasPointer();\n  var isCenterWithCustomWidth = slideWidth === \"custom\" && align === \"center\";\n  var transformCssStyles = function (shiftX) {\n    var animation = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : false;\n    slidesManager.current.loopPoints.forEach(function (loopPoint) {\n      var target = loopPoint.target,\n        index = loopPoint.index;\n      var slide = slidesStore.current[index];\n      if (slide) {\n        slide.style.transform = \"translate3d(\".concat(target(shiftX), \"px, 0, 0)\");\n      }\n    });\n    if (layerRef.current) {\n      layerRef.current.style.transform = \"translate3d(\".concat(shiftX, \"px, 0, 0)\");\n      layerRef.current.style.transition = animation ? \"transform \".concat(ANIMATION_DURATION, \"ms cubic-bezier(.1, 0, .25, 1)\") : \"\";\n    }\n  };\n  var requestTransform = function (shiftX) {\n    var animation = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : false;\n    var _slidesManager_current = slidesManager.current,\n      snaps = _slidesManager_current.snaps,\n      contentSize = _slidesManager_current.contentSize,\n      slides = _slidesManager_current.slides;\n    if (animationFrameRef.current !== null) {\n      cancelAnimationFrame(animationFrameRef.current);\n    }\n    animationFrameRef.current = requestAnimationFrame(function () {\n      if (shiftX > snaps[0]) {\n        shiftXCurrentRef.current = -contentSize + snaps[0];\n        shiftX = shiftXCurrentRef.current + shiftXDeltaRef.current;\n      }\n      var lastPoint = slides[slides.length - 1].width + slides[slides.length - 1].coordX;\n      if (shiftX <= -lastPoint) {\n        shiftXCurrentRef.current = Math.abs(shiftXDeltaRef.current) + snaps[0];\n      }\n      transformCssStyles(shiftX, animation);\n    });\n  };\n  var initializeSlides = function () {\n    if (!rootRef.current || !viewportRef.current) {\n      return;\n    }\n    var localSlides = React.Children.map(children, function (_item, i) {\n      var elem = slidesStore.current[i] || {\n        offsetLeft: 0,\n        offsetWidth: 0\n      };\n      return {\n        coordX: elem.offsetLeft,\n        width: elem.offsetWidth\n      };\n    }) || [];\n    var containerWidth = rootRef.current.offsetWidth;\n    var viewportOffsetWidth = viewportRef.current.offsetWidth;\n    var layerWidth = localSlides.reduce(function (val, slide) {\n      return slide.width + val;\n    }, 0);\n    if (process.env.NODE_ENV === \"development\") {\n      var remainingWidth = containerWidth;\n      var slideIndex1 = 0;\n      while (remainingWidth > 0 && slideIndex1 < localSlides.length) {\n        remainingWidth -= localSlides[slideIndex1].width;\n        slideIndex1++;\n      }\n      if (remainingWidth <= 0 && slideIndex1 === localSlides.length) {\n        warn('Ширины слайдов недостаточно для корректной работы свойства \"looped\". Пожалуйста, сделайте её больше.\"');\n      }\n    }\n    if (align === \"center\") {\n      var firstSlideShift = (containerWidth - localSlides[0].width) / 2;\n      localSlides = localSlides.map(function (item) {\n        return {\n          width: item.width,\n          coordX: item.coordX - firstSlideShift\n        };\n      });\n    }\n    slidesManager.current = _object_spread_props(_object_spread({}, slidesManager.current), {\n      viewportOffsetWidth: viewportOffsetWidth,\n      slides: localSlides,\n      isFullyVisible: layerWidth <= containerWidth\n    });\n    var snaps = localSlides.map(function (_, index) {\n      return calculateIndent(index, slidesManager.current, isCenterWithCustomWidth);\n    });\n    var contentSize = -snaps[snaps.length - 1] + localSlides[localSlides.length - 1].width;\n    if (align === \"center\") {\n      contentSize += snaps[0];\n    }\n    slidesManager.current.snaps = snaps;\n    slidesManager.current.contentSize = contentSize;\n    slidesManager.current.loopPoints = getLoopPoints(slidesManager.current, containerWidth);\n    setControlElementsState({\n      canSlideLeft: !slidesManager.current.isFullyVisible,\n      canSlideRight: !slidesManager.current.isFullyVisible,\n      isDraggable: isDraggableProp && !slidesManager.current.isFullyVisible\n    });\n    shiftXCurrentRef.current = snaps[slideIndex];\n    initialized.current = true;\n    requestTransform(shiftXCurrentRef.current);\n  };\n  var onResize = function () {\n    if (initialized.current) {\n      initializeSlides();\n    }\n  };\n  useGlobalEventListener(window, \"resize\", onResize);\n  useIsomorphicLayoutEffect(function performSlideChange() {\n    if (!initialized.current) {\n      return;\n    }\n    var _slidesManager_current = slidesManager.current,\n      snaps = _slidesManager_current.snaps,\n      slides = _slidesManager_current.slides;\n    var indent = snaps[slideIndex];\n    var startPoint = shiftXCurrentRef.current;\n    /**\n    * Переключаемся с последнего элемента на первый\n    * Для корректной анимации мы прокручиваем последний слайд на всю длину (shiftX) \"вперед\"\n    * В конце анимации при отрисовке следующего кадра задаем всем слайдам начальные значения\n    */\n    if (indent === snaps[0] && shiftXCurrentRef.current <= snaps[snaps.length - 1]) {\n      var distance = Math.abs(snaps[snaps.length - 1]) + slides[slides.length - 1].width + startPoint;\n      addToAnimationQueue(getAnimateFunction(function (progress) {\n        var shiftX = startPoint + progress * distance * -1;\n        transformCssStyles(shiftX);\n        if (shiftX <= snaps[snaps.length - 1] - slides[slides.length - 1].width) {\n          requestAnimationFrame(function () {\n            shiftXCurrentRef.current = indent;\n            transformCssStyles(snaps[0]);\n          });\n        }\n      }));\n      /**\n       * Переключаемся с первого слайда на последний\n       * Для корректной анимации сначала задаем первым видимым слайдам смещение\n       * В следующем кадре начинаем анимация прокрутки \"назад\"\n       */\n    } else if (indent === snaps[snaps.length - 1] && shiftXCurrentRef.current === snaps[0]) {\n      startPoint = indent - slides[slides.length - 1].width;\n      addToAnimationQueue(function () {\n        requestAnimationFrame(function () {\n          var shiftX = indent - slides[slides.length - 1].width;\n          transformCssStyles(shiftX);\n          getAnimateFunction(function (progress) {\n            transformCssStyles(startPoint + progress * slides[slides.length - 1].width);\n          })();\n        });\n      });\n      /**\n       * Если не обработаны `corner`-кейсы выше, то просто проигрываем анимацию смещения\n       */\n    } else {\n      addToAnimationQueue(function () {\n        var distance = Math.abs(indent - startPoint);\n        var direction = startPoint <= indent ? 1 : -1;\n        getAnimateFunction(function (progress) {\n          var shiftX = startPoint + progress * distance * direction;\n          transformCssStyles(shiftX);\n        })();\n      });\n    }\n    startAnimation();\n    shiftXCurrentRef.current = indent;\n  }, [slideIndex]);\n  useIsomorphicLayoutEffect(function () {\n    initializeSlides();\n  }, [children, align, slideWidth]);\n  var slideLeft = function (event) {\n    onChange === null || onChange === void 0 ? void 0 : onChange((slideIndex - 1 + slidesManager.current.slides.length) % slidesManager.current.slides.length);\n    onPrevClick === null || onPrevClick === void 0 ? void 0 : onPrevClick(event);\n  };\n  var slideRight = function (event) {\n    onChange === null || onChange === void 0 ? void 0 : onChange((slideIndex + 1) % slidesManager.current.slides.length);\n    onNextClick === null || onNextClick === void 0 ? void 0 : onNextClick(event);\n  };\n  var onStart = function (e) {\n    e.originalEvent.stopPropagation();\n    onDragStart === null || onDragStart === void 0 ? void 0 : onDragStart(e);\n    shiftXCurrentRef.current = slidesManager.current.snaps[slideIndex];\n    shiftXDeltaRef.current = 0;\n  };\n  var onMoveX = function (e) {\n    if (isDraggableProp && !slidesManager.current.isFullyVisible) {\n      e.originalEvent.preventDefault();\n      if (e.isSlideX) {\n        if (shiftXDeltaRef.current !== e.shiftX) {\n          shiftXDeltaRef.current = e.shiftX;\n          requestTransform(shiftXCurrentRef.current + shiftXDeltaRef.current);\n        }\n      }\n    }\n  };\n  var onEnd = function (e) {\n    var targetIndex = slideIndex;\n    if (e.isSlide) {\n      targetIndex = getTargetIndex(slidesManager.current.slides, slideIndex, shiftXCurrentRef.current, shiftXDeltaRef.current);\n    }\n    onDragEnd === null || onDragEnd === void 0 ? void 0 : onDragEnd(e, targetIndex);\n    if (targetIndex !== slideIndex) {\n      shiftXCurrentRef.current = shiftXCurrentRef.current + shiftXDeltaRef.current;\n      onChange === null || onChange === void 0 ? void 0 : onChange(targetIndex);\n    } else {\n      var initialShiftX = slidesManager.current.snaps[targetIndex];\n      requestTransform(initialShiftX, true);\n    }\n  };\n  var setSlideRef = function (slideRef, slideIndex) {\n    slidesStore.current[slideIndex] = slideRef;\n  };\n  var canSlideLeft = controlElementsState.canSlideLeft,\n    canSlideRight = controlElementsState.canSlideRight,\n    isDraggable = controlElementsState.isDraggable;\n  return /*#__PURE__*/React.createElement(RootComponent, _object_spread_props(_object_spread({}, restProps), {\n    baseClassName: classNames(\"vkuiBaseGallery\", slideWidth === \"custom\" && \"vkuiBaseGallery--custom-width\", isDraggable && \"vkuiBaseGallery--draggable\"),\n    getRootRef: rootRef\n  }), /*#__PURE__*/React.createElement(Touch, {\n    className: \"vkuiBaseGallery__viewport\",\n    onStartX: onStart,\n    onMoveX: onMoveX,\n    onEnd: onEnd,\n    style: {\n      width: slideWidth === \"custom\" ? \"100%\" : slideWidth\n    },\n    getRootRef: viewportRef,\n    noSlideClick: true\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"vkuiBaseGallery__layer\",\n    ref: layerRef\n  }, React.Children.map(children, function (item, i) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"vkuiBaseGallery__slide\",\n      key: \"slide-\".concat(i),\n      ref: function (el) {\n        return setSlideRef(el, i);\n      }\n    }, item);\n  }))), bullets && /*#__PURE__*/React.createElement(\"div\", {\n    \"aria-hidden\": true,\n    className: classNames(\"vkuiBaseGallery__bullets\", stylesBullets[bullets])\n  }, React.Children.map(children, function (_item, index) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: classNames(\"vkuiBaseGallery__bullet\", index === slideIndex && \"vkuiBaseGallery__bullet--active\"),\n      key: index\n    });\n  })), showArrows && hasPointer && canSlideLeft && /*#__PURE__*/React.createElement(ScrollArrow, {\n    className: \"vkuiBaseGallery__arrow\",\n    direction: \"left\",\n    onClick: slideLeft,\n    size: arrowSize\n  }), showArrows && hasPointer && canSlideRight && /*#__PURE__*/React.createElement(ScrollArrow, {\n    className: \"vkuiBaseGallery__arrow\",\n    direction: \"right\",\n    onClick: slideRight,\n    size: arrowSize\n  }));\n};","map":{"version":3,"names":["React","classNames","useAdaptivityHasPointer","useExternRef","useGlobalEventListener","useDOM","useIsomorphicLayoutEffect","warnOnce","RootComponent","ScrollArrow","Touch","ANIMATION_DURATION","CONTROL_ELEMENTS_STATE","SLIDES_MANAGER_STATE","calculateIndent","getLoopPoints","getTargetIndex","useSlideAnimation","stylesBullets","dark","light","warn","CarouselBase","_param","bullets","_param_bullets","getRootRef","children","_param_slideWidth","slideWidth","_param_slideIndex","slideIndex","tmp","isDraggable","isDraggableProp","onDragStart","onDragEnd","onChange","onPrevClick","onNextClick","_param_align","align","showArrows","getRef","_param_arrowSize","arrowSize","restProps","_object_without_properties","slidesStore","useRef","slidesManager","rootRef","viewportRef","layerRef","animationFrameRef","shiftXCurrentRef","shiftXDeltaRef","initialized","_useSlideAnimation","addToAnimationQueue","getAnimateFunction","startAnimation","_React_useState","_sliced_to_array","useState","controlElementsState","setControlElementsState","window","hasPointer","isCenterWithCustomWidth","transformCssStyles","shiftX","animation","arguments","length","current","loopPoints","forEach","loopPoint","target","index","slide","style","transform","concat","transition","requestTransform","_slidesManager_current","snaps","contentSize","slides","cancelAnimationFrame","requestAnimationFrame","lastPoint","width","coordX","Math","abs","initializeSlides","localSlides","Children","map","_item","i","elem","offsetLeft","offsetWidth","containerWidth","viewportOffsetWidth","layerWidth","reduce","val","process","env","NODE_ENV","remainingWidth","slideIndex1","firstSlideShift","item","_object_spread_props","_object_spread","isFullyVisible","_","canSlideLeft","canSlideRight","onResize","performSlideChange","indent","startPoint","distance","progress","direction","slideLeft","event","slideRight","onStart","e","originalEvent","stopPropagation","onMoveX","preventDefault","isSlideX","onEnd","targetIndex","isSlide","initialShiftX","setSlideRef","slideRef","createElement","baseClassName","className","onStartX","noSlideClick","ref","key","el","onClick","size"],"sources":["../../../../src/components/BaseGallery/CarouselBase/CarouselBase.tsx"],"sourcesContent":["import * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport { useAdaptivityHasPointer } from '../../../hooks/useAdaptivityHasPointer';\nimport { useExternRef } from '../../../hooks/useExternRef';\nimport { useGlobalEventListener } from '../../../hooks/useGlobalEventListener';\nimport { useDOM } from '../../../lib/dom';\nimport { useIsomorphicLayoutEffect } from '../../../lib/useIsomorphicLayoutEffect';\nimport { warnOnce } from '../../../lib/warnOnce';\nimport { RootComponent } from '../../RootComponent/RootComponent';\nimport { ScrollArrow } from '../../ScrollArrow/ScrollArrow';\nimport { Touch, TouchEvent } from '../../Touch/Touch';\nimport { BaseGalleryProps, GallerySlidesState } from '../types';\nimport { ANIMATION_DURATION, CONTROL_ELEMENTS_STATE, SLIDES_MANAGER_STATE } from './constants';\nimport { calculateIndent, getLoopPoints, getTargetIndex } from './helpers';\nimport { useSlideAnimation } from './hooks';\nimport { ControlElementsState, SlidesManagerState } from './types';\nimport styles from '../BaseGallery.module.css';\n\nconst stylesBullets = {\n  dark: styles['BaseGallery__bullets--dark'],\n  light: styles['BaseGallery__bullets--light'],\n};\n\nconst warn = warnOnce('Gallery');\n\nexport const CarouselBase = ({\n  bullets = false,\n  getRootRef,\n  children,\n  slideWidth = '100%',\n  slideIndex = 0,\n  isDraggable: isDraggableProp = true,\n  onDragStart,\n  onDragEnd,\n  onChange,\n  onPrevClick,\n  onNextClick,\n  align = 'left',\n  showArrows,\n  getRef,\n  arrowSize = 'l',\n  ...restProps\n}: BaseGalleryProps) => {\n  const slidesStore = React.useRef<Record<string, HTMLDivElement | null>>({});\n  const slidesManager = React.useRef<SlidesManagerState>(SLIDES_MANAGER_STATE);\n\n  const rootRef = useExternRef(getRootRef);\n  const viewportRef = useExternRef(getRef);\n  const layerRef = React.useRef<HTMLDivElement>(null);\n  const animationFrameRef = React.useRef<ReturnType<typeof requestAnimationFrame> | null>(null);\n  const shiftXCurrentRef = React.useRef<number>(0);\n  const shiftXDeltaRef = React.useRef<number>(0);\n  const initialized = React.useRef<boolean>(false);\n  const { addToAnimationQueue, getAnimateFunction, startAnimation } = useSlideAnimation();\n\n  const [controlElementsState, setControlElementsState] =\n    React.useState<ControlElementsState>(CONTROL_ELEMENTS_STATE);\n\n  const { window } = useDOM();\n  const hasPointer = useAdaptivityHasPointer();\n\n  const isCenterWithCustomWidth = slideWidth === 'custom' && align === 'center';\n\n  const transformCssStyles = (shiftX: number, animation = false) => {\n    slidesManager.current.loopPoints.forEach((loopPoint) => {\n      const { target, index } = loopPoint;\n      const slide = slidesStore.current[index];\n      if (slide) {\n        slide.style.transform = `translate3d(${target(shiftX)}px, 0, 0)`;\n      }\n    });\n\n    if (layerRef.current) {\n      layerRef.current.style.transform = `translate3d(${shiftX}px, 0, 0)`;\n      layerRef.current.style.transition = animation\n        ? `transform ${ANIMATION_DURATION}ms cubic-bezier(.1, 0, .25, 1)`\n        : '';\n    }\n  };\n\n  const requestTransform = (shiftX: number, animation = false) => {\n    const { snaps, contentSize, slides } = slidesManager.current;\n\n    if (animationFrameRef.current !== null) {\n      cancelAnimationFrame(animationFrameRef.current);\n    }\n    animationFrameRef.current = requestAnimationFrame(() => {\n      if (shiftX > snaps[0]) {\n        shiftXCurrentRef.current = -contentSize + snaps[0];\n        shiftX = shiftXCurrentRef.current + shiftXDeltaRef.current;\n      }\n      const lastPoint = slides[slides.length - 1].width + slides[slides.length - 1].coordX;\n\n      if (shiftX <= -lastPoint) {\n        shiftXCurrentRef.current = Math.abs(shiftXDeltaRef.current) + snaps[0];\n      }\n      transformCssStyles(shiftX, animation);\n    });\n  };\n\n  const initializeSlides = () => {\n    if (!rootRef.current || !viewportRef.current) {\n      return;\n    }\n    let localSlides =\n      React.Children.map(children, (_item, i): GallerySlidesState => {\n        const elem = slidesStore.current[i] || { offsetLeft: 0, offsetWidth: 0 };\n        return { coordX: elem.offsetLeft, width: elem.offsetWidth };\n      }) || [];\n\n    const containerWidth = rootRef.current.offsetWidth;\n    const viewportOffsetWidth = viewportRef.current.offsetWidth;\n    const layerWidth = localSlides.reduce((val, slide) => slide.width + val, 0);\n\n    if (process.env.NODE_ENV === 'development') {\n      let remainingWidth = containerWidth;\n      let slideIndex = 0;\n\n      while (remainingWidth > 0 && slideIndex < localSlides.length) {\n        remainingWidth -= localSlides[slideIndex].width;\n        slideIndex++;\n      }\n      if (remainingWidth <= 0 && slideIndex === localSlides.length) {\n        warn(\n          'Ширины слайдов недостаточно для корректной работы свойства \"looped\". Пожалуйста, сделайте её больше.\"',\n        );\n      }\n    }\n    if (align === 'center') {\n      const firstSlideShift = (containerWidth - localSlides[0].width) / 2;\n      localSlides = localSlides.map((item) => {\n        return {\n          width: item.width,\n          coordX: item.coordX - firstSlideShift,\n        };\n      });\n    }\n\n    slidesManager.current = {\n      ...slidesManager.current,\n      viewportOffsetWidth,\n      slides: localSlides,\n      isFullyVisible: layerWidth <= containerWidth,\n    };\n\n    const snaps = localSlides.map((_, index) =>\n      calculateIndent(index, slidesManager.current, isCenterWithCustomWidth),\n    );\n\n    let contentSize = -snaps[snaps.length - 1] + localSlides[localSlides.length - 1].width;\n    if (align === 'center') {\n      contentSize += snaps[0];\n    }\n\n    slidesManager.current.snaps = snaps;\n    slidesManager.current.contentSize = contentSize;\n    slidesManager.current.loopPoints = getLoopPoints(slidesManager.current, containerWidth);\n\n    setControlElementsState({\n      canSlideLeft: !slidesManager.current.isFullyVisible,\n      canSlideRight: !slidesManager.current.isFullyVisible,\n      isDraggable: isDraggableProp && !slidesManager.current.isFullyVisible,\n    });\n\n    shiftXCurrentRef.current = snaps[slideIndex];\n    initialized.current = true;\n\n    requestTransform(shiftXCurrentRef.current);\n  };\n\n  const onResize = () => {\n    if (initialized.current) {\n      initializeSlides();\n    }\n  };\n\n  useGlobalEventListener(window, 'resize', onResize);\n\n  useIsomorphicLayoutEffect(\n    function performSlideChange() {\n      if (!initialized.current) {\n        return;\n      }\n      const { snaps, slides } = slidesManager.current;\n      const indent = snaps[slideIndex];\n      let startPoint = shiftXCurrentRef.current;\n\n      /**\n       * Переключаемся с последнего элемента на первый\n       * Для корректной анимации мы прокручиваем последний слайд на всю длину (shiftX) \"вперед\"\n       * В конце анимации при отрисовке следующего кадра задаем всем слайдам начальные значения\n       */\n      if (indent === snaps[0] && shiftXCurrentRef.current <= snaps[snaps.length - 1]) {\n        const distance =\n          Math.abs(snaps[snaps.length - 1]) + slides[slides.length - 1].width + startPoint;\n\n        addToAnimationQueue(\n          getAnimateFunction((progress) => {\n            const shiftX = startPoint + progress * distance * -1;\n\n            transformCssStyles(shiftX);\n\n            if (shiftX <= snaps[snaps.length - 1] - slides[slides.length - 1].width) {\n              requestAnimationFrame(() => {\n                shiftXCurrentRef.current = indent;\n                transformCssStyles(snaps[0]);\n              });\n            }\n          }),\n        );\n        /**\n         * Переключаемся с первого слайда на последний\n         * Для корректной анимации сначала задаем первым видимым слайдам смещение\n         * В следующем кадре начинаем анимация прокрутки \"назад\"\n         */\n      } else if (indent === snaps[snaps.length - 1] && shiftXCurrentRef.current === snaps[0]) {\n        startPoint = indent - slides[slides.length - 1].width;\n\n        addToAnimationQueue(() => {\n          requestAnimationFrame(() => {\n            const shiftX = indent - slides[slides.length - 1].width;\n            transformCssStyles(shiftX);\n\n            getAnimateFunction((progress) => {\n              transformCssStyles(startPoint + progress * slides[slides.length - 1].width);\n            })();\n          });\n        });\n        /**\n         * Если не обработаны `corner`-кейсы выше, то просто проигрываем анимацию смещения\n         */\n      } else {\n        addToAnimationQueue(() => {\n          const distance = Math.abs(indent - startPoint);\n          let direction = startPoint <= indent ? 1 : -1;\n\n          getAnimateFunction((progress) => {\n            const shiftX = startPoint + progress * distance * direction;\n            transformCssStyles(shiftX);\n          })();\n        });\n      }\n\n      startAnimation();\n\n      shiftXCurrentRef.current = indent;\n    },\n    [slideIndex],\n  );\n\n  useIsomorphicLayoutEffect(() => {\n    initializeSlides();\n  }, [children, align, slideWidth]);\n\n  const slideLeft = (event: React.MouseEvent) => {\n    onChange?.(\n      (slideIndex - 1 + slidesManager.current.slides.length) % slidesManager.current.slides.length,\n    );\n    onPrevClick?.(event);\n  };\n\n  const slideRight = (event: React.MouseEvent) => {\n    onChange?.((slideIndex + 1) % slidesManager.current.slides.length);\n    onNextClick?.(event);\n  };\n\n  const onStart = (e: TouchEvent) => {\n    e.originalEvent.stopPropagation();\n    onDragStart?.(e);\n    shiftXCurrentRef.current = slidesManager.current.snaps[slideIndex];\n    shiftXDeltaRef.current = 0;\n  };\n\n  const onMoveX = (e: TouchEvent) => {\n    if (isDraggableProp && !slidesManager.current.isFullyVisible) {\n      e.originalEvent.preventDefault();\n\n      if (e.isSlideX) {\n        if (shiftXDeltaRef.current !== e.shiftX) {\n          shiftXDeltaRef.current = e.shiftX;\n          requestTransform(shiftXCurrentRef.current + shiftXDeltaRef.current);\n        }\n      }\n    }\n  };\n\n  const onEnd = (e: TouchEvent) => {\n    let targetIndex = slideIndex;\n    if (e.isSlide) {\n      targetIndex = getTargetIndex(\n        slidesManager.current.slides,\n        slideIndex,\n        shiftXCurrentRef.current,\n        shiftXDeltaRef.current,\n      );\n    }\n    onDragEnd?.(e, targetIndex);\n\n    if (targetIndex !== slideIndex) {\n      shiftXCurrentRef.current = shiftXCurrentRef.current + shiftXDeltaRef.current;\n      onChange?.(targetIndex);\n    } else {\n      const initialShiftX = slidesManager.current.snaps[targetIndex];\n      requestTransform(initialShiftX, true);\n    }\n  };\n\n  const setSlideRef = (slideRef: HTMLDivElement | null, slideIndex: number) => {\n    slidesStore.current[slideIndex] = slideRef;\n  };\n\n  const { canSlideLeft, canSlideRight, isDraggable } = controlElementsState;\n\n  return (\n    <RootComponent\n      {...restProps}\n      baseClassName={classNames(\n        styles['BaseGallery'],\n        slideWidth === 'custom' && styles['BaseGallery--custom-width'],\n        isDraggable && styles['BaseGallery--draggable'],\n      )}\n      getRootRef={rootRef}\n    >\n      <Touch\n        className={styles['BaseGallery__viewport']}\n        onStartX={onStart}\n        onMoveX={onMoveX}\n        onEnd={onEnd}\n        style={{ width: slideWidth === 'custom' ? '100%' : slideWidth }}\n        getRootRef={viewportRef}\n        noSlideClick\n      >\n        <div className={styles['BaseGallery__layer']} ref={layerRef}>\n          {React.Children.map(children, (item: React.ReactNode, i: number) => (\n            <div\n              className={styles['BaseGallery__slide']}\n              key={`slide-${i}`}\n              ref={(el) => setSlideRef(el, i)}\n            >\n              {item}\n            </div>\n          ))}\n        </div>\n      </Touch>\n\n      {bullets && (\n        <div\n          aria-hidden\n          className={classNames(styles['BaseGallery__bullets'], stylesBullets[bullets])}\n        >\n          {React.Children.map(children, (_item: React.ReactNode, index: number) => (\n            <div\n              className={classNames(\n                styles['BaseGallery__bullet'],\n                index === slideIndex && styles['BaseGallery__bullet--active'],\n              )}\n              key={index}\n            />\n          ))}\n        </div>\n      )}\n\n      {showArrows && hasPointer && canSlideLeft && (\n        <ScrollArrow\n          className={styles['BaseGallery__arrow']}\n          direction=\"left\"\n          onClick={slideLeft}\n          size={arrowSize}\n        />\n      )}\n      {showArrows && hasPointer && canSlideRight && (\n        <ScrollArrow\n          className={styles['BaseGallery__arrow']}\n          direction=\"right\"\n          onClick={slideRight}\n          size={arrowSize}\n        />\n      )}\n    </RootComponent>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}