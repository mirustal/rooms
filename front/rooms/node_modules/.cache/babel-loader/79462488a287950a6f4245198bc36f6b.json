{"ast":null,"code":"import _asyncToGenerator from\"/Users/mirustal/Documents/project/rooms/front/rooms/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/mirustal/Documents/project/rooms/front/rooms/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/mirustal/Documents/project/rooms/front/rooms/node_modules/@babel/runtime/regenerator/index.js\";import React,{useContext,useState}from\"react\";import{Icon16MoreVertical,Icon20DeleteOutline,Icon20ShareOutline,Icon20WriteOutline,Icon28DeleteOutline,Icon28DoorArrowRightOutline,Icon28EditOutline,Icon28ShareOutline}from\"@vkontakte/icons\";import{ActionSheet,ActionSheetItem}from\"@vkontakte/vkui\";import{copyToClipboard,createInviteURL,getFromStorage,perfomAppText,pushToStorage,removeFromStorage,shareInviteLink}from\"../../../bridge/bridgeLib\";import{Locales}from\"../../../locales/locales\";import{VkStorageKeys}from\"../../../bridge/storageKeys\";import{deleteRoom as _deleteRoom}from\"../../../serverApi/serverApi\";import{AlertManagerContext,DeleteErrorAlert}from\"../../contexts/AlertProvider\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function AlterActionSheet(_ref){var targetRef=_ref.targetRef,roomInfo=_ref.roomInfo,returnBack=_ref.returnBack,handleActiveEditMode=_ref.handleActiveEditMode,userIsAdmin=_ref.userIsAdmin;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),actionSheet=_useState2[0],setActionSheet=_useState2[1];var onClose=function onClose(){return setActionSheet(null);};var alertManager=useContext(AlertManagerContext);var iconsTargetRef=React.useRef();function handleExitRoom(){return _handleExitRoom.apply(this,arguments);}function _handleExitRoom(){_handleExitRoom=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var idFromStorage,idToRemove,updatedString;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getFromStorage(VkStorageKeys.JoinedRooms);case 2:idFromStorage=_context.sent;idToRemove=\",\"+roomInfo.id;updatedString=idFromStorage.replace(new RegExp(idToRemove,'g'),\"\");pushToStorage(VkStorageKeys.JoinedRooms,updatedString);returnBack();case 7:case\"end\":return _context.stop();}}},_callee);}));return _handleExitRoom.apply(this,arguments);}function handleShareRoom(){return _handleShareRoom.apply(this,arguments);}function _handleShareRoom(){_handleShareRoom=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return shareInviteLink(roomInfo.id);case 2:case\"end\":return _context2.stop();}}},_callee2);}));return _handleShareRoom.apply(this,arguments);}var handleDeleteRoom=function handleDeleteRoom(){alertManager.showAlert(DeleteErrorAlert({alertManager:alertManager,deleteRoom:function deleteRoom(){_deleteRoom(roomInfo.id);returnBack();}}));};var openActionSheet=function openActionSheet(){console.log(userIsAdmin);setActionSheet(/*#__PURE__*/_jsxs(ActionSheet,{onClose:onClose,placement:\"center\",toggleRef:iconsTargetRef,children:[/*#__PURE__*/_jsx(ActionSheetItem,{onClick:handleShareRoom,autoClose:true,before:/*#__PURE__*/_jsx(Icon28ShareOutline,{}),children:Locales.ActionSheetName.ShareRoom}),userIsAdmin&&/*#__PURE__*/_jsx(ActionSheetItem,{onClick:handleActiveEditMode,autoClose:true,before:/*#__PURE__*/_jsx(Icon28EditOutline,{}),children:Locales.ActionSheetName.EditRoom}),userIsAdmin&&/*#__PURE__*/_jsx(ActionSheetItem,{onClick:handleDeleteRoom,autoClose:true,before:/*#__PURE__*/_jsx(Icon28DeleteOutline,{}),mode:\"destructive\",children:Locales.ActionSheetName.DeleteRoom}),!userIsAdmin&&/*#__PURE__*/_jsx(ActionSheetItem,{onClick:handleExitRoom,autoClose:true,before:/*#__PURE__*/_jsx(Icon28DoorArrowRightOutline,{}),children:Locales.ActionSheetName.ExitRoom})]}));};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Icon16MoreVertical,{style:{marginTop:\"2px\"},getRootRef:iconsTargetRef,onClick:openActionSheet}),actionSheet]});}export default AlterActionSheet;","map":{"version":3,"names":["React","useContext","useState","Icon16MoreVertical","Icon20DeleteOutline","Icon20ShareOutline","Icon20WriteOutline","Icon28DeleteOutline","Icon28DoorArrowRightOutline","Icon28EditOutline","Icon28ShareOutline","ActionSheet","ActionSheetItem","copyToClipboard","createInviteURL","getFromStorage","perfomAppText","pushToStorage","removeFromStorage","shareInviteLink","Locales","VkStorageKeys","deleteRoom","AlertManagerContext","DeleteErrorAlert","AlterActionSheet","targetRef","roomInfo","returnBack","handleActiveEditMode","userIsAdmin","actionSheet","setActionSheet","onClose","alertManager","iconsTargetRef","useRef","handleExitRoom","JoinedRooms","idFromStorage","idToRemove","id","updatedString","replace","RegExp","handleShareRoom","handleDeleteRoom","showAlert","openActionSheet","console","log","ActionSheetName","ShareRoom","EditRoom","DeleteRoom","ExitRoom","marginTop"],"sources":["/Users/mirustal/Documents/project/rooms/front/rooms/src/components/views/Channels/AlterActionSheet.jsx"],"sourcesContent":["import React, { useContext, useState } from \"react\";\nimport {\n  Icon16MoreVertical,\n  Icon20DeleteOutline,\n  Icon20ShareOutline,\n  Icon20WriteOutline,\n  Icon28DeleteOutline,\n  Icon28DoorArrowRightOutline,\n  Icon28EditOutline,\n  Icon28ShareOutline,\n} from \"@vkontakte/icons\";\n\nimport { ActionSheet, ActionSheetItem } from \"@vkontakte/vkui\";\nimport {\n  copyToClipboard,\n  createInviteURL,\n  getFromStorage,\n  perfomAppText,\n  pushToStorage,\n  removeFromStorage,\n  shareInviteLink,\n} from \"../../../bridge/bridgeLib\";\nimport { Locales } from \"../../../locales/locales\";\nimport { VkStorageKeys } from \"../../../bridge/storageKeys\";\nimport { deleteRoom } from \"../../../serverApi/serverApi\";\nimport {\n  AlertManagerContext,\n  DeleteErrorAlert,\n} from \"../../contexts/AlertProvider\";\n\nfunction AlterActionSheet({ targetRef, roomInfo, returnBack, handleActiveEditMode, userIsAdmin }) {\n  const [actionSheet, setActionSheet] = useState(null);\n  const onClose = () => setActionSheet(null);\n  const alertManager = useContext(AlertManagerContext);\n  const iconsTargetRef = React.useRef();\n\n\n\n  async function handleExitRoom() {\n    let idFromStorage = await getFromStorage(VkStorageKeys.JoinedRooms);\n    let idToRemove = \",\" + roomInfo.id\n    let updatedString = idFromStorage.replace(new RegExp(idToRemove, 'g'), \"\");\n    pushToStorage(VkStorageKeys.JoinedRooms, updatedString)\n    returnBack()\n  }\n\n  async function handleShareRoom() {\n    await shareInviteLink(roomInfo.id)\n  }\n\n  const handleDeleteRoom = () => {\n    alertManager.showAlert(\n      DeleteErrorAlert({\n        alertManager: alertManager,\n        deleteRoom: () => {\n          deleteRoom(roomInfo.id);\n          returnBack();\n        },\n      })\n    );\n  };\n\n  const openActionSheet = () => {\n    console.log(userIsAdmin)\n    setActionSheet(\n      <ActionSheet\n        onClose={onClose}\n        placement=\"center\"\n        toggleRef={iconsTargetRef}\n      >\n\n        <ActionSheetItem\n          onClick={handleShareRoom}\n          autoClose\n          before={<Icon28ShareOutline />}\n        >\n          {Locales.ActionSheetName.ShareRoom}\n\n        </ActionSheetItem>\n        {userIsAdmin && <ActionSheetItem\n          onClick={handleActiveEditMode}\n          autoClose\n          before={<Icon28EditOutline />}\n        >\n          {Locales.ActionSheetName.EditRoom}\n        </ActionSheetItem>}\n\n        {userIsAdmin && <ActionSheetItem\n          onClick={handleDeleteRoom}\n\n          autoClose\n          before={<Icon28DeleteOutline />}\n          mode=\"destructive\"\n        >\n          {Locales.ActionSheetName.DeleteRoom}\n        </ActionSheetItem>}\n\n         {!userIsAdmin && <ActionSheetItem\n          onClick={handleExitRoom}\n          autoClose\n          before={<Icon28DoorArrowRightOutline/>}>\n              {Locales.ActionSheetName.ExitRoom}\n          </ActionSheetItem>\n  }\n\n      </ActionSheet>\n    );\n  };\n\n  return (\n    <>\n      <Icon16MoreVertical\n      Â  style={{marginTop: \"2px\"}}\n        getRootRef={iconsTargetRef}\n        onClick={openActionSheet}\n      />\n      {actionSheet}\n    </>\n  );\n}\n\nexport default AlterActionSheet;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}