{"ast":null,"code":"import { canUseDOM } from \"./dom\";\nexport var IPHONE_SAFARI_BOTTOM_BAR = 45;\nexport var IPHONE_X_SAFARI_BOTTOM_BAR = 85;\nexport var IPHONE_KEYBOARD_REJECT_OFFSET = 180;\n// 44 iPhone, 55 iPad, iPad Pro 69\nexport var IOS_NO_KEYBOARD_ALLOWED_OFFSET = 70;\nexport function detectIOS(ua) {\n  if (!ua) {\n    ua = canUseDOM ? navigator.userAgent : \"\";\n  }\n  ua = ua.toLowerCase();\n  var isIPadOS = checkIPadOS(ua);\n  var isIPad = isIPadOS || ua.includes(\"ipad\");\n  var isIPhone = !isIPad && ua.search(/iphone|ipod/) !== -1;\n  var isIOS = isIPhone || isIPad;\n  var iosVersion = isIOS && ua.match(/os ([\\d_]+) like mac os x/i);\n  var iosMajor = 0;\n  var iosMinor = 0;\n  if (isIPadOS) {\n    iosMajor = 13;\n    iosMinor = 0;\n  } else if (iosVersion) {\n    iosVersion = iosVersion[1].split(\"_\");\n    iosMajor = +iosVersion[0];\n    iosMinor = +iosVersion[1];\n  }\n  iosVersion = null;\n  var isScrollBasedViewport = iosMajor < 13 && !(iosMajor === 11 && iosMinor < 3);\n  var isWKWebView = isIOS && checkWKWebView(ua);\n  var isIPhoneX = false;\n  if (canUseDOM) {\n    isIPhoneX = isIOS && screen.width === 375 && screen.height === 812 && window.devicePixelRatio === 3;\n  }\n  var isIOSChrome = ua.search(/crios/i) !== -1;\n  return {\n    isIPad: isIPad,\n    isIPhone: isIPhone,\n    isIOS: isIOS,\n    isIPadOS: isIPadOS,\n    iosMajor: iosMajor,\n    iosMinor: iosMinor,\n    isWKWebView: isWKWebView,\n    isScrollBasedViewport: isScrollBasedViewport,\n    isIPhoneX: isIPhoneX,\n    isIOSChrome: isIOSChrome\n  };\n}\nvar detect = /*#__PURE__*/detectIOS();\nexport var isIPad = /*#__PURE__*/function () {\n  return detect.isIPad;\n}();\nexport var isIPhone = /*#__PURE__*/function () {\n  return detect.isIPhone;\n}();\nexport var isIOS = /*#__PURE__*/function () {\n  return detect.isIOS;\n}();\nexport var isIPadOS = /*#__PURE__*/function () {\n  return detect.isIPadOS;\n}();\nexport var iosMajor = /*#__PURE__*/function () {\n  return detect.iosMajor;\n}();\nexport var iosMinor = /*#__PURE__*/function () {\n  return detect.iosMinor;\n}();\nexport var isWKWebView = /*#__PURE__*/function () {\n  return detect.isWKWebView;\n}();\nexport var isScrollBasedViewport = /*#__PURE__*/function () {\n  return detect.isScrollBasedViewport;\n}();\nexport var isIPhoneX = /*#__PURE__*/function () {\n  return detect.isIPhoneX;\n}();\nexport var isIOSChrome = /*#__PURE__*/function () {\n  return detect.isIOSChrome;\n}();\nexport function isLandscapePhone() {\n  return Math.abs(window.orientation) === 90 && !isIPad;\n}\n// Reference:\n// https://stackoverflow.com/questions/28795476/detect-if-page-is-loaded-inside-wkwebview-in-javascript/30495399#30495399\nfunction checkWKWebView(ua) {\n  if (!canUseDOM) {\n    return false;\n  }\n  var webkit = window.webkit;\n  if (webkit && webkit.messageHandlers) {\n    return true;\n  }\n  var lte9 = /constructor/i.test(String(window.HTMLElement));\n  var idb = !!window.indexedDB;\n  if (ua.includes(\"safari\") && ua.includes(\"version\") && !navigator.standalone) {} else\n    // Safari (WKWebView/Nitro since 6+)\n    if (!idb && lte9 || !(window.statusbar && window.statusbar.visible)) {} else\n      // UIWebView\n      if (!lte9 || idb) {\n        // WKWebView\n        return true;\n      }\n  return false;\n}\nexport function checkIPadOS(ua) {\n  if (!canUseDOM) {\n    return false;\n  }\n  var notIOS = !/ipad|iphone|ipod/.test(ua);\n  var macOS = ua.includes(\"mac os\");\n  if (macOS && notIOS && typeof navigator.standalone === \"boolean\") {\n    return true;\n  }\n  return false;\n}","map":{"version":3,"names":["canUseDOM","IPHONE_SAFARI_BOTTOM_BAR","IPHONE_X_SAFARI_BOTTOM_BAR","IPHONE_KEYBOARD_REJECT_OFFSET","IOS_NO_KEYBOARD_ALLOWED_OFFSET","detectIOS","ua","navigator","userAgent","toLowerCase","isIPadOS","checkIPadOS","isIPad","includes","isIPhone","search","isIOS","iosVersion","match","iosMajor","iosMinor","split","isScrollBasedViewport","isWKWebView","checkWKWebView","isIPhoneX","screen","width","height","window","devicePixelRatio","isIOSChrome","detect","isLandscapePhone","Math","abs","orientation","webkit","messageHandlers","lte9","test","String","HTMLElement","idb","indexedDB","standalone","statusbar","visible","notIOS","macOS"],"sources":["../../src/IOSDetections.ts"],"sourcesContent":["import { canUseDOM } from './dom';\n\nexport const IPHONE_SAFARI_BOTTOM_BAR = 45;\nexport const IPHONE_X_SAFARI_BOTTOM_BAR = 85;\n\nexport const IPHONE_KEYBOARD_REJECT_OFFSET = 180;\n\n// 44 iPhone, 55 iPad, iPad Pro 69\nexport const IOS_NO_KEYBOARD_ALLOWED_OFFSET = 70;\n\nexport function detectIOS(ua?: string) {\n  if (!ua) {\n    ua = canUseDOM ? navigator.userAgent : '';\n  }\n  ua = ua.toLowerCase();\n\n  const isIPadOS = checkIPadOS(ua);\n  const isIPad = isIPadOS || ua.includes('ipad');\n  const isIPhone = !isIPad && ua.search(/iphone|ipod/) !== -1;\n  const isIOS = isIPhone || isIPad;\n\n  let iosVersion: string[] | typeof isIOS | ReturnType<typeof String.prototype.match> =\n    isIOS && ua.match(/os ([\\d_]+) like mac os x/i);\n  let iosMajor = 0;\n  let iosMinor = 0;\n\n  if (isIPadOS) {\n    iosMajor = 13;\n    iosMinor = 0;\n  } else if (iosVersion) {\n    iosVersion = iosVersion[1].split('_');\n    iosMajor = +iosVersion[0];\n    iosMinor = +iosVersion[1];\n  }\n\n  iosVersion = null;\n\n  const isScrollBasedViewport = iosMajor < 13 && !(iosMajor === 11 && iosMinor < 3);\n  const isWKWebView = isIOS && checkWKWebView(ua);\n\n  let isIPhoneX = false;\n\n  if (canUseDOM) {\n    isIPhoneX =\n      isIOS && screen.width === 375 && screen.height === 812 && window.devicePixelRatio === 3;\n  }\n\n  const isIOSChrome = ua.search(/crios/i) !== -1;\n\n  return {\n    isIPad,\n    isIPhone,\n    isIOS,\n    isIPadOS,\n    iosMajor,\n    iosMinor,\n    isWKWebView,\n    isScrollBasedViewport,\n    isIPhoneX,\n    isIOSChrome,\n  };\n}\n\nconst detect = /*#__PURE__*/ detectIOS();\n\nexport const isIPad = /*#__PURE__*/ (() => detect.isIPad)();\nexport const isIPhone = /*#__PURE__*/ (() => detect.isIPhone)();\nexport const isIOS = /*#__PURE__*/ (() => detect.isIOS)();\nexport const isIPadOS = /*#__PURE__*/ (() => detect.isIPadOS)();\nexport const iosMajor = /*#__PURE__*/ (() => detect.iosMajor)();\nexport const iosMinor = /*#__PURE__*/ (() => detect.iosMinor)();\nexport const isWKWebView = /*#__PURE__*/ (() => detect.isWKWebView)();\nexport const isScrollBasedViewport = /*#__PURE__*/ (() => detect.isScrollBasedViewport)();\nexport const isIPhoneX = /*#__PURE__*/ (() => detect.isIPhoneX)();\nexport const isIOSChrome = /*#__PURE__*/ (() => detect.isIOSChrome)();\n\nexport function isLandscapePhone() {\n  return Math.abs(window.orientation) === 90 && !isIPad;\n}\n\n// Reference:\n// https://stackoverflow.com/questions/28795476/detect-if-page-is-loaded-inside-wkwebview-in-javascript/30495399#30495399\nfunction checkWKWebView(ua: string) {\n  if (!canUseDOM) {\n    return false;\n  }\n\n  const webkit = (window as any).webkit;\n\n  if (webkit && webkit.messageHandlers) {\n    return true;\n  }\n\n  const lte9 = /constructor/i.test(String(window.HTMLElement));\n  const idb = !!window.indexedDB;\n\n  if (ua.includes('safari') && ua.includes('version') && !(navigator as any).standalone) {\n    // Safari (WKWebView/Nitro since 6+)\n  } else if ((!idb && lte9) || !(window.statusbar && window.statusbar.visible)) {\n    // UIWebView\n  } else if (!lte9 || idb) {\n    // WKWebView\n    return true;\n  }\n\n  return false;\n}\n\nexport function checkIPadOS(ua: string) {\n  if (!canUseDOM) {\n    return false;\n  }\n\n  const notIOS = !/ipad|iphone|ipod/.test(ua);\n  const macOS = ua.includes('mac os');\n\n  if (macOS && notIOS && typeof (navigator as any).standalone === 'boolean') {\n    return true;\n  }\n\n  return false;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}