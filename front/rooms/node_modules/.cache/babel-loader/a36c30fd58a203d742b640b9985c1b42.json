{"ast":null,"code":"import { _ as _sliced_to_array } from \"@swc/helpers/_/_sliced_to_array\";\nimport * as React from \"react\";\nimport { useDOM } from \"../lib/dom\";\nimport { useGlobalEventListener } from \"./useGlobalEventListener\";\n/**\n Проверяет, закрыла ли клавиатура часть экрана, 24% подошло к большинству устройств\n Работает на iOS и Android, где софт-клавиатура ресайзит viewport в браузерах\n */\nexport function getPreciseKeyboardState(window) {\n  var innerHeight = window.innerHeight,\n    availHeight = window.screen.availHeight;\n  var coveredViewportPercentage = Math.round((1 - innerHeight / availHeight) * 100);\n  return coveredViewportPercentage > 24;\n}\nvar eventOptions = {\n  passive: true,\n  capture: false\n};\nexport function useKeyboard() {\n  var _document_activeElement;\n  var document = useDOM().document;\n  var _React_useState = _sliced_to_array(React.useState(false), 2),\n    isOpened = _React_useState[0],\n    setIsOpened = _React_useState[1];\n  var onFocus = React.useCallback(function (event) {\n    var _document_activeElement, _document_activeElement1;\n    var isOpened = (event === true || event.type === \"focusin\") && ((document === null || document === void 0 ? void 0 : (_document_activeElement = document.activeElement) === null || _document_activeElement === void 0 ? void 0 : _document_activeElement.tagName) === \"INPUT\" || (document === null || document === void 0 ? void 0 : (_document_activeElement1 = document.activeElement) === null || _document_activeElement1 === void 0 ? void 0 : _document_activeElement1.tagName) === \"TEXTAREA\");\n    setIsOpened(isOpened);\n  }, [document === null || document === void 0 ? void 0 : (_document_activeElement = document.activeElement) === null || _document_activeElement === void 0 ? void 0 : _document_activeElement.tagName]);\n  /**\n  У полей с autoFocus не отлавливаются события focus, для этого вызываем вручную,\n  чтобы иметь хоть какое-то понимание происходящего.\n  */\n  React.useEffect(function () {\n    onFocus(true);\n  }, [onFocus]);\n  useGlobalEventListener(document, \"focusout\", onFocus, eventOptions);\n  useGlobalEventListener(document, \"focusin\", onFocus, eventOptions);\n  return {\n    isOpened: isOpened\n  };\n}","map":{"version":3,"names":["React","useDOM","useGlobalEventListener","getPreciseKeyboardState","window","innerHeight","availHeight","screen","coveredViewportPercentage","Math","round","eventOptions","passive","capture","useKeyboard","_document_activeElement","document","_React_useState","_sliced_to_array","useState","isOpened","setIsOpened","onFocus","useCallback","event","_document_activeElement1","type","activeElement","tagName","useEffect"],"sources":["../../src/hooks/useKeyboard.ts"],"sourcesContent":["import * as React from 'react';\nimport { useDOM } from '../lib/dom';\nimport { useGlobalEventListener } from './useGlobalEventListener';\n\ninterface SoftwareKeyboardState {\n  isOpened: boolean;\n}\n\n/**\n Проверяет, закрыла ли клавиатура часть экрана, 24% подошло к большинству устройств\n Работает на iOS и Android, где софт-клавиатура ресайзит viewport в браузерах\n */\nexport function getPreciseKeyboardState(window: any): boolean {\n  const {\n    innerHeight,\n    screen: { availHeight },\n  } = window;\n\n  const coveredViewportPercentage = Math.round((1 - innerHeight / availHeight) * 100);\n  return coveredViewportPercentage > 24;\n}\n\nconst eventOptions = {\n  passive: true,\n  capture: false,\n};\n\nexport function useKeyboard(): SoftwareKeyboardState {\n  const { document } = useDOM();\n\n  const [isOpened, setIsOpened] = React.useState(false);\n\n  const onFocus = React.useCallback(\n    (event: FocusEvent | true) => {\n      const isOpened =\n        (event === true || event.type === 'focusin') &&\n        (document?.activeElement?.tagName === 'INPUT' ||\n          document?.activeElement?.tagName === 'TEXTAREA');\n      setIsOpened(isOpened);\n    },\n    [document?.activeElement?.tagName],\n  );\n\n  /**\n   У полей с autoFocus не отлавливаются события focus, для этого вызываем вручную,\n   чтобы иметь хоть какое-то понимание происходящего.\n   */\n  React.useEffect(() => {\n    onFocus(true);\n  }, [onFocus]);\n\n  useGlobalEventListener(document, 'focusout', onFocus, eventOptions);\n  useGlobalEventListener(document, 'focusin', onFocus, eventOptions);\n\n  return { isOpened };\n}\n"],"mappings":";AAAA,YAAYA,KAAA,MAAW;AACvB,SAASC,MAAM,QAAQ;AACvB,SAASC,sBAAsB,QAAQ;AAMvC;;;;AAIA,OAAO,SAASC,wBAAwBC,MAAW;EACjD,IACEC,WAAA,GAEED,MAAA,CAFFC,WAAA;IACAC,WAAU,GACRF,MAAA,CADFG,MAAA,CAAUD,WAAA;EAGZ,IAAME,yBAAA,GAA4BC,IAAA,CAAKC,KAAK,CAAC,CAAC,IAAIL,WAAA,GAAcC,WAAU,IAAK;EAC/E,OAAOE,yBAAA,GAA4B;AACrC;AAEA,IAAMG,YAAA,GAAe;EACnBC,OAAA,EAAS;EACTC,OAAA,EAAS;AACX;AAEA,OAAO,SAASC,YAAA;MAaXC,uBAAA;EAZH,IAAMC,QAAE,GAAaf,MAAA,GAAbe,QAAA;EAER,IAAgCC,eAAA,GAAAC,gBAAA,CAAAlB,KAAA,CAAMmB,QAAQ,CAAC;IAAxCC,QAAA,GAAyBH,eAAA;IAAfI,WAAA,GAAeJ,eAAA;EAEhC,IAAMK,OAAA,GAAUtB,KAAA,CAAMuB,WAAW,CAC/B,UAACC,KAAA;QAGIT,uBAAA,EACCU,wBAAA;IAHJ,IAAML,QAAA,GACJ,CAACI,KAAA,KAAU,QAAQA,KAAA,CAAME,IAAI,KAAK,SAAQ,MACzC,CAAAV,QAAA,aAAAA,QAAA,wBAAAD,uBAAA,GAAAC,QAAA,CAAUW,aAAa,cAAvBZ,uBAAA,uBAAAA,uBAAA,CAAyBa,OAAO,MAAK,WACpC,CAAAZ,QAAA,aAAAA,QAAA,wBAAAS,wBAAA,GAAAT,QAAA,CAAUW,aAAa,cAAvBF,wBAAA,uBAAAA,wBAAA,CAAyBG,OAAO,MAAK,UAAS;IAClDP,WAAA,CAAYD,QAAA;EACd,GACA,CAACJ,QAAA,aAAAA,QAAA,wBAAAD,uBAAA,GAAAC,QAAA,CAAUW,aAAa,cAAvBZ,uBAAA,uBAAAA,uBAAA,CAAyBa,OAAO,CAAC;EAGpC;;;;EAIA5B,KAAA,CAAM6B,SAAS,CAAC;IACdP,OAAA,CAAQ;EACV,GAAG,CAACA,OAAA,CAAQ;EAEZpB,sBAAA,CAAuBc,QAAA,EAAU,YAAYM,OAAA,EAASX,YAAA;EACtDT,sBAAA,CAAuBc,QAAA,EAAU,WAAWM,OAAA,EAASX,YAAA;EAErD,OAAO;IAAES,QAAA,EAAAA;EAAS;AACpB"},"metadata":{},"sourceType":"module"}