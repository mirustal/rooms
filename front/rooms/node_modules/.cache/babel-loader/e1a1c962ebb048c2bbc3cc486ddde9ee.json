{"ast":null,"code":"import { _ as _define_property } from \"@swc/helpers/_/_define_property\";\nimport { _ as _object_spread } from \"@swc/helpers/_/_object_spread\";\nimport { _ as _object_spread_props } from \"@swc/helpers/_/_object_spread_props\";\nimport { _ as _object_without_properties } from \"@swc/helpers/_/_object_without_properties\";\nimport { _ as _sliced_to_array } from \"@swc/helpers/_/_sliced_to_array\";\nimport * as React from \"react\";\nimport { classNames } from \"@vkontakte/vkjs\";\nimport { useAdaptivity } from \"../../hooks/useAdaptivity\";\nimport { useEnsuredControl } from \"../../hooks/useEnsuredControl\";\nimport { useExternRef } from \"../../hooks/useExternRef\";\nimport { SizeType } from \"../../lib/adaptivity\";\nimport { FormField } from \"../FormField/FormField\";\nimport { Text } from \"../Typography/Text/Text\";\nvar sizeYClassNames = _define_property({\n  none: \"vkuiTextarea--sizeY-none\"\n}, SizeType.COMPACT, \"vkuiTextarea--sizeY-compact\");\n/**\n * @see https://vkcom.github.io/VKUI/#/Textarea\n */\nexport var Textarea = function (_param) {\n  var _param_defaultValue = _param.defaultValue,\n    defaultValue = _param_defaultValue === void 0 ? \"\" : _param_defaultValue,\n    _param_grow = _param.grow,\n    grow = _param_grow === void 0 ? true : _param_grow,\n    style = _param.style,\n    onResize = _param.onResize,\n    className = _param.className,\n    getRootRef = _param.getRootRef,\n    getRef = _param.getRef,\n    _param_rows = _param.rows,\n    rows = _param_rows === void 0 ? 2 : _param_rows,\n    maxHeight = _param.maxHeight,\n    status = _param.status,\n    onChangeProp = _param.onChange,\n    valueProp = _param.value,\n    restProps = _object_without_properties(_param, [\"defaultValue\", \"grow\", \"style\", \"onResize\", \"className\", \"getRootRef\", \"getRef\", \"rows\", \"maxHeight\", \"status\", \"onChange\", \"value\"]);\n  var _useEnsuredControl = _sliced_to_array(useEnsuredControl({\n      defaultValue: defaultValue,\n      onChange: onChangeProp,\n      value: valueProp\n    }), 2),\n    value = _useEnsuredControl[0],\n    onChange = _useEnsuredControl[1];\n  var currentScrollHeight = React.useRef();\n  var elementRef = useExternRef(getRef);\n  var _useAdaptivity = useAdaptivity(),\n    _useAdaptivity_sizeY = _useAdaptivity.sizeY,\n    sizeY = _useAdaptivity_sizeY === void 0 ? \"none\" : _useAdaptivity_sizeY;\n  // autosize input\n  React.useEffect(function () {\n    var el = elementRef.current;\n    if (grow && (el === null || el === void 0 ? void 0 : el.offsetParent)) {\n      el.style.height = \"\";\n      el.style.height = \"\".concat(el.scrollHeight, \"px\");\n      if (el.scrollHeight !== currentScrollHeight.current && onResize) {\n        onResize(el);\n        currentScrollHeight.current = el.scrollHeight;\n      }\n    }\n  }, [grow, value, sizeY, elementRef, onResize]);\n  return /*#__PURE__*/React.createElement(FormField, {\n    className: classNames(\"vkuiTextarea\", sizeY !== SizeType.REGULAR && sizeYClassNames[sizeY], className),\n    style: style,\n    getRootRef: getRootRef,\n    disabled: restProps.disabled,\n    status: status\n  }, /*#__PURE__*/React.createElement(Text, _object_spread_props(_object_spread({}, restProps), {\n    Component: \"textarea\",\n    normalize: false,\n    style: {\n      maxHeight: maxHeight\n    },\n    rows: rows,\n    className: \"vkuiTextarea__el\",\n    value: value,\n    onChange: onChange,\n    getRootRef: elementRef\n  })));\n};","map":{"version":3,"names":["React","classNames","useAdaptivity","useEnsuredControl","useExternRef","SizeType","FormField","Text","sizeYClassNames","_define_property","none","COMPACT","Textarea","_param","defaultValue","_param_defaultValue","_param_grow","grow","style","onResize","className","getRootRef","getRef","_param_rows","rows","maxHeight","status","onChangeProp","onChange","valueProp","value","restProps","_object_without_properties","_useEnsuredControl","_sliced_to_array","currentScrollHeight","useRef","elementRef","_useAdaptivity","_useAdaptivity_sizeY","sizeY","useEffect","el","current","offsetParent","height","concat","scrollHeight","createElement","REGULAR","disabled","_object_spread_props","_object_spread","Component","normalize"],"sources":["../../../src/components/Textarea/Textarea.tsx"],"sourcesContent":["import * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport { useAdaptivity } from '../../hooks/useAdaptivity';\nimport { useEnsuredControl } from '../../hooks/useEnsuredControl';\nimport { useExternRef } from '../../hooks/useExternRef';\nimport { SizeType } from '../../lib/adaptivity';\nimport { HasRef, HasRootRef } from '../../types';\nimport { FormField, FormFieldProps } from '../FormField/FormField';\nimport { Text } from '../Typography/Text/Text';\nimport styles from './Textarea.module.css';\n\nconst sizeYClassNames = {\n  none: styles['Textarea--sizeY-none'],\n  [SizeType.COMPACT]: styles['Textarea--sizeY-compact'],\n};\n\nexport interface TextareaProps\n  extends React.TextareaHTMLAttributes<HTMLTextAreaElement>,\n    HasRef<HTMLTextAreaElement>,\n    HasRootRef<HTMLElement>,\n    Pick<React.CSSProperties, 'maxHeight'>,\n    Pick<FormFieldProps, 'status'> {\n  grow?: boolean;\n  onResize?(el: HTMLTextAreaElement): void;\n  defaultValue?: string;\n}\n\n/**\n * @see https://vkcom.github.io/VKUI/#/Textarea\n */\nexport const Textarea = ({\n  defaultValue = '',\n  grow = true,\n  style,\n  onResize,\n  className,\n  getRootRef,\n  getRef,\n  rows = 2,\n  maxHeight,\n  status,\n  onChange: onChangeProp,\n  value: valueProp,\n  ...restProps\n}: TextareaProps) => {\n  const [value, onChange] = useEnsuredControl({\n    defaultValue,\n    onChange: onChangeProp,\n    value: valueProp,\n  });\n  const currentScrollHeight = React.useRef<number>();\n  const elementRef = useExternRef(getRef);\n  const { sizeY = 'none' } = useAdaptivity();\n\n  // autosize input\n  React.useEffect(() => {\n    const el = elementRef.current;\n\n    if (grow && el?.offsetParent) {\n      el.style.height = '';\n      el.style.height = `${el.scrollHeight}px`;\n\n      if (el.scrollHeight !== currentScrollHeight.current && onResize) {\n        onResize(el);\n        currentScrollHeight.current = el.scrollHeight;\n      }\n    }\n  }, [grow, value, sizeY, elementRef, onResize]);\n\n  return (\n    <FormField\n      className={classNames(\n        styles['Textarea'],\n        sizeY !== SizeType.REGULAR && sizeYClassNames[sizeY],\n        className,\n      )}\n      style={style}\n      getRootRef={getRootRef}\n      disabled={restProps.disabled}\n      status={status}\n    >\n      <Text\n        {...restProps}\n        Component=\"textarea\"\n        normalize={false}\n        style={{ maxHeight }}\n        rows={rows}\n        className={styles['Textarea__el']}\n        value={value}\n        onChange={onChange}\n        getRootRef={elementRef}\n      />\n    </FormField>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}