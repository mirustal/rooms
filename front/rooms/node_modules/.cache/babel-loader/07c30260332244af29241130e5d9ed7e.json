{"ast":null,"code":"import { _ as _define_property } from \"@swc/helpers/_/_define_property\";\nimport { _ as _object_spread } from \"@swc/helpers/_/_object_spread\";\nimport { _ as _object_spread_props } from \"@swc/helpers/_/_object_spread_props\";\nimport { _ as _object_without_properties } from \"@swc/helpers/_/_object_without_properties\";\nimport { _ as _sliced_to_array } from \"@swc/helpers/_/_sliced_to_array\";\nimport * as React from \"react\";\nimport { classNames } from \"@vkontakte/vkjs\";\nimport { useAdaptivity } from \"../../hooks/useAdaptivity\";\nimport { useGlobalEventListener } from \"../../hooks/useGlobalEventListener\";\nimport { usePlatform } from \"../../hooks/usePlatform\";\nimport { useTimeout } from \"../../hooks/useTimeout\";\nimport { SizeType } from \"../../lib/adaptivity\";\nimport { useDOM } from \"../../lib/dom\";\nimport { Platform } from \"../../lib/platform\";\nimport { useIsomorphicLayoutEffect } from \"../../lib/useIsomorphicLayoutEffect\";\nimport { useScrollLock } from \"../AppRoot/ScrollContext\";\nimport { FixedLayout } from \"../FixedLayout/FixedLayout\";\nvar _obj;\nvar sizeXClassNames = (_obj = {\n  none: \"vkuiPanelHeaderContext--sizeX-none\"\n}, _define_property(_obj, SizeType.COMPACT, \"vkuiPanelHeaderContext--sizeX-compact\"), _define_property(_obj, SizeType.REGULAR, \"vkuiPanelHeaderContext--sizeX-regular\"), _obj);\n/**\n * @see https://vkcom.github.io/VKUI/#/PanelHeaderContext\n */\nexport var PanelHeaderContext = function (_param) {\n  var children = _param.children,\n    onClose = _param.onClose,\n    _param_opened = _param.opened,\n    opened = _param_opened === void 0 ? false : _param_opened,\n    className = _param.className,\n    restProps = _object_without_properties(_param, [\"children\", \"onClose\", \"opened\", \"className\"]);\n  var document = useDOM().document;\n  var platform = usePlatform();\n  var _React_useState = _sliced_to_array(React.useState(opened), 2),\n    visible = _React_useState[0],\n    setVisible = _React_useState[1];\n  var closing = visible && !opened;\n  var _useAdaptivity = useAdaptivity(),\n    _useAdaptivity_sizeX = _useAdaptivity.sizeX,\n    sizeX = _useAdaptivity_sizeX === void 0 ? \"none\" : _useAdaptivity_sizeX;\n  var elementRef = React.useRef(null);\n  useIsomorphicLayoutEffect(function () {\n    opened && setVisible(true);\n  }, [opened]);\n  useScrollLock(platform !== Platform.VKCOM && opened);\n  // start closing on outer click\n  useGlobalEventListener(document, \"click\", opened && !closing && function (event) {\n    if (elementRef.current && !elementRef.current.contains(event.target)) {\n      event.stopPropagation();\n      onClose();\n    }\n  }, {\n    capture: true\n  });\n  // fallback onAnimationEnd when animationend not supported\n  var onAnimationEnd = function () {\n    return setVisible(false);\n  };\n  var animationFallback = useTimeout(onAnimationEnd, 200);\n  React.useEffect(function () {\n    return closing ? animationFallback.set() : animationFallback.clear();\n  }, [animationFallback, closing]);\n  return /*#__PURE__*/React.createElement(FixedLayout, _object_spread_props(_object_spread({}, restProps), {\n    className: classNames(\"vkuiPanelHeaderContext\", platform === Platform.IOS && \"vkuiPanelHeaderContext--ios\", opened && \"vkuiPanelHeaderContext--opened\", closing && \"vkuiPanelHeaderContext--closing\", sizeXClassNames[sizeX], className),\n    vertical: \"top\"\n  }), visible && /*#__PURE__*/React.createElement(\"div\", {\n    onClick: function (event) {\n      event.stopPropagation();\n      onClose();\n    },\n    className: \"vkuiPanelHeaderContext__fade\"\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"vkuiPanelHeaderContext__in\",\n    ref: elementRef,\n    onAnimationEnd: closing ? onAnimationEnd : undefined\n  }, visible && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"vkuiPanelHeaderContext__content\"\n  }, children)));\n};","map":{"version":3,"names":["React","classNames","useAdaptivity","useGlobalEventListener","usePlatform","useTimeout","SizeType","useDOM","Platform","useIsomorphicLayoutEffect","useScrollLock","FixedLayout","_obj","sizeXClassNames","none","COMPACT","_define_property","REGULAR","PanelHeaderContext","_param","children","onClose","_param_opened","opened","className","restProps","_object_without_properties","document","platform","_React_useState","_sliced_to_array","useState","visible","setVisible","closing","_useAdaptivity","_useAdaptivity_sizeX","sizeX","elementRef","useRef","VKCOM","event","current","contains","target","stopPropagation","capture","onAnimationEnd","animationFallback","useEffect","set","clear","createElement","_object_spread_props","_object_spread","IOS","vertical","onClick","ref","undefined"],"sources":["../../../src/components/PanelHeaderContext/PanelHeaderContext.tsx"],"sourcesContent":["import * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport { useAdaptivity } from '../../hooks/useAdaptivity';\nimport { useGlobalEventListener } from '../../hooks/useGlobalEventListener';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport { useTimeout } from '../../hooks/useTimeout';\nimport { SizeType } from '../../lib/adaptivity';\nimport { useDOM } from '../../lib/dom';\nimport { Platform } from '../../lib/platform';\nimport { useIsomorphicLayoutEffect } from '../../lib/useIsomorphicLayoutEffect';\nimport { HTMLAttributesWithRootRef } from '../../types';\nimport { useScrollLock } from '../AppRoot/ScrollContext';\nimport { FixedLayout } from '../FixedLayout/FixedLayout';\nimport styles from './PanelHeaderContext.module.css';\n\nconst sizeXClassNames = {\n  none: styles['PanelHeaderContext--sizeX-none'],\n  [SizeType.COMPACT]: styles['PanelHeaderContext--sizeX-compact'],\n  [SizeType.REGULAR]: styles['PanelHeaderContext--sizeX-regular'],\n};\n\nexport interface PanelHeaderContextProps extends HTMLAttributesWithRootRef<HTMLDivElement> {\n  opened: boolean;\n  onClose: VoidFunction;\n}\n\n/**\n * @see https://vkcom.github.io/VKUI/#/PanelHeaderContext\n */\nexport const PanelHeaderContext = ({\n  children,\n  onClose,\n  opened = false,\n  className,\n  ...restProps\n}: PanelHeaderContextProps) => {\n  const { document } = useDOM();\n  const platform = usePlatform();\n  const [visible, setVisible] = React.useState(opened);\n  const closing = visible && !opened;\n  const { sizeX = 'none' } = useAdaptivity();\n  const elementRef = React.useRef<HTMLDivElement>(null);\n\n  useIsomorphicLayoutEffect(() => {\n    opened && setVisible(true);\n  }, [opened]);\n\n  useScrollLock(platform !== Platform.VKCOM && opened);\n\n  // start closing on outer click\n  useGlobalEventListener(\n    document,\n    'click',\n    opened &&\n      !closing &&\n      ((event) => {\n        if (elementRef.current && !elementRef.current.contains(event.target as Node)) {\n          event.stopPropagation();\n          onClose();\n        }\n      }),\n    { capture: true },\n  );\n\n  // fallback onAnimationEnd when animationend not supported\n  const onAnimationEnd = () => setVisible(false);\n  const animationFallback = useTimeout(onAnimationEnd, 200);\n  React.useEffect(\n    () => (closing ? animationFallback.set() : animationFallback.clear()),\n    [animationFallback, closing],\n  );\n\n  return (\n    <FixedLayout\n      {...restProps}\n      className={classNames(\n        styles['PanelHeaderContext'],\n        platform === Platform.IOS && styles['PanelHeaderContext--ios'],\n        opened && styles['PanelHeaderContext--opened'],\n        closing && styles['PanelHeaderContext--closing'],\n        sizeXClassNames[sizeX],\n        className,\n      )}\n      vertical=\"top\"\n    >\n      {visible && (\n        <div\n          onClick={(event) => {\n            event.stopPropagation();\n            onClose();\n          }}\n          className={styles['PanelHeaderContext__fade']}\n        />\n      )}\n      <div\n        className={styles['PanelHeaderContext__in']}\n        ref={elementRef}\n        onAnimationEnd={closing ? onAnimationEnd : undefined}\n      >\n        {visible && <div className={styles['PanelHeaderContext__content']}>{children}</div>}\n      </div>\n    </FixedLayout>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}