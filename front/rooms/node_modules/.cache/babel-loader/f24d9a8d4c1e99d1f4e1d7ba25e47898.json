{"ast":null,"code":"import { _ as _object_spread } from \"@swc/helpers/_/_object_spread\";\nimport * as React from \"react\";\nimport { noop } from \"@vkontakte/vkjs\";\nimport { canUseDOM } from \"../lib/dom\";\nimport { useIsomorphicLayoutEffect } from \"../lib/useIsomorphicLayoutEffect\";\nexport function useEventListener(event, _cb, _options) {\n  var cbRef = React.useRef(_cb);\n  useIsomorphicLayoutEffect(function () {\n    cbRef.current = _cb;\n  }, [_cb]);\n  var cb = React.useCallback(function (e) {\n    return cbRef.current && cbRef.current(e);\n  }, []);\n  var detach = React.useRef(noop);\n  var remove = React.useCallback(function () {\n    detach.current();\n    detach.current = noop;\n  }, []);\n  var add = React.useCallback(function (el) {\n    if (!canUseDOM) {\n      return;\n    }\n    remove();\n    if (!el) {\n      return;\n    }\n    var options = _object_spread({}, _options);\n    el.addEventListener(event, cb, options);\n    detach.current = function () {\n      return el.removeEventListener(event, cb, options);\n    };\n  }, [_options, cb, event, remove]);\n  React.useEffect(function () {\n    return remove;\n  }, [remove]);\n  return React.useMemo(function () {\n    return {\n      add: add,\n      remove: remove\n    };\n  }, [add, remove]);\n}","map":{"version":3,"names":["React","noop","canUseDOM","useIsomorphicLayoutEffect","useEventListener","event","_cb","_options","cbRef","useRef","current","cb","useCallback","e","detach","remove","add","el","options","_object_spread","addEventListener","removeEventListener","useEffect","useMemo"],"sources":["../../src/hooks/useEventListener.ts"],"sourcesContent":["import * as React from 'react';\nimport { noop } from '@vkontakte/vkjs';\nimport { canUseDOM } from '../lib/dom';\nimport { useIsomorphicLayoutEffect } from '../lib/useIsomorphicLayoutEffect';\n\ninterface EventListenerHandle {\n  add: (el: HTMLElement | Document | Window) => void;\n  remove: () => void;\n}\n\nexport function useEventListener<K extends keyof GlobalEventHandlersEventMap>(\n  event: K,\n  _cb: false | null | undefined | ((ev: GlobalEventHandlersEventMap[K]) => void),\n  _options?: AddEventListenerOptions,\n): EventListenerHandle;\nexport function useEventListener<E extends Event>(\n  event: string,\n  _cb: false | null | undefined | ((ev: E) => void),\n  _options?: AddEventListenerOptions,\n): EventListenerHandle;\nexport function useEventListener<E extends Event, K extends keyof GlobalEventHandlersEventMap>(\n  event: string | K,\n  _cb: false | null | undefined | ((ev: E) => void),\n  _options?: AddEventListenerOptions,\n): EventListenerHandle {\n  const cbRef = React.useRef(_cb);\n  useIsomorphicLayoutEffect(() => {\n    cbRef.current = _cb;\n  }, [_cb]);\n  const cb = React.useCallback((e: any) => cbRef.current && cbRef.current(e), []);\n\n  const detach = React.useRef(noop);\n  const remove = React.useCallback(() => {\n    detach.current();\n    detach.current = noop;\n  }, []);\n  const add = React.useCallback(\n    (el: HTMLElement | Document | Window) => {\n      if (!canUseDOM) {\n        return;\n      }\n      remove();\n      if (!el) {\n        return;\n      }\n      const options = { ..._options };\n      el.addEventListener(event, cb, options);\n      detach.current = () => el.removeEventListener(event, cb, options);\n    },\n    [_options, cb, event, remove],\n  );\n  React.useEffect(() => remove, [remove]);\n\n  return React.useMemo(() => ({ add, remove }), [add, remove]);\n}\n"],"mappings":";AAAA,YAAYA,KAAA,MAAW;AACvB,SAASC,IAAI,QAAQ;AACrB,SAASC,SAAS,QAAQ;AAC1B,SAASC,yBAAyB,QAAQ;AAiB1C,OAAO,SAASC,iBACdC,KAAiB,EACjBC,GAAiD,EACjDC,QAAkC;EAElC,IAAMC,KAAA,GAAQR,KAAA,CAAMS,MAAM,CAACH,GAAA;EAC3BH,yBAAA,CAA0B;IACxBK,KAAA,CAAME,OAAO,GAAGJ,GAAA;EAClB,GAAG,CAACA,GAAA,CAAI;EACR,IAAMK,EAAA,GAAKX,KAAA,CAAMY,WAAW,CAAC,UAACC,CAAA;WAAWL,KAAA,CAAME,OAAO,IAAIF,KAAA,CAAME,OAAO,CAACG,CAAA;KAAI,EAAE;EAE9E,IAAMC,MAAA,GAASd,KAAA,CAAMS,MAAM,CAACR,IAAA;EAC5B,IAAMc,MAAA,GAASf,KAAA,CAAMY,WAAW,CAAC;IAC/BE,MAAA,CAAOJ,OAAO;IACdI,MAAA,CAAOJ,OAAO,GAAGT,IAAA;EACnB,GAAG,EAAE;EACL,IAAMe,GAAA,GAAMhB,KAAA,CAAMY,WAAW,CAC3B,UAACK,EAAA;IACC,IAAI,CAACf,SAAA,EAAW;MACd;IACF;IACAa,MAAA;IACA,IAAI,CAACE,EAAA,EAAI;MACP;IACF;IACA,IAAMC,OAAA,GAAUC,cAAA,KAAKZ,QAAA;IACrBU,EAAA,CAAGG,gBAAgB,CAACf,KAAA,EAAOM,EAAA,EAAIO,OAAA;IAC/BJ,MAAA,CAAOJ,OAAO,GAAG;aAAMO,EAAA,CAAGI,mBAAmB,CAAChB,KAAA,EAAOM,EAAA,EAAIO,OAAA;;EAC3D,GACA,CAACX,QAAA,EAAUI,EAAA,EAAIN,KAAA,EAAOU,MAAA,CAAO;EAE/Bf,KAAA,CAAMsB,SAAS,CAAC;WAAMP,MAAA;KAAQ,CAACA,MAAA,CAAO;EAEtC,OAAOf,KAAA,CAAMuB,OAAO,CAAC;WAAO;MAAEP,GAAA,EAAAA,GAAA;MAAKD,MAAA,EAAAA;IAAO;KAAI,CAACC,GAAA,EAAKD,MAAA,CAAO;AAC7D"},"metadata":{},"sourceType":"module"}