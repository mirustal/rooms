{"ast":null,"code":"import { _ as _object_spread } from \"@swc/helpers/_/_object_spread\";\nimport { _ as _object_spread_props } from \"@swc/helpers/_/_object_spread_props\";\nimport { _ as _object_without_properties } from \"@swc/helpers/_/_object_without_properties\";\nimport * as React from \"react\";\nimport { classNames } from \"@vkontakte/vkjs\";\nimport { useAdaptivityWithJSMediaQueries } from \"../../hooks/useAdaptivityWithJSMediaQueries\";\nimport { useEffectDev } from \"../../hooks/useEffectDev\";\nimport { useEventListener } from \"../../hooks/useEventListener\";\nimport { usePlatform } from \"../../hooks/usePlatform\";\nimport { SizeType } from \"../../lib/adaptivity\";\nimport { useDOM } from \"../../lib/dom\";\nimport { isRefObject } from \"../../lib/isRefObject\";\nimport { Platform } from \"../../lib/platform\";\nimport { warnOnce } from \"../../lib/warnOnce\";\nimport { FocusTrap } from \"../FocusTrap/FocusTrap\";\nimport { Popper } from \"../Popper/Popper\";\nvar warn = warnOnce(\"ActionSheet\");\nfunction getEl(ref) {\n  return ref && \"current\" in ref ? ref.current : ref;\n}\nexport var ActionSheetDropdownMenu = function (_param) {\n  var children = _param.children,\n    toggleRef = _param.toggleRef,\n    closing = _param.closing,\n    popupDirection = _param.popupDirection,\n    onClose = _param.onClose,\n    className = _param.className,\n    style = _param.style,\n    _param_popupOffsetDistance = _param.popupOffsetDistance,\n    popupOffsetDistance = _param_popupOffsetDistance === void 0 ? 0 : _param_popupOffsetDistance,\n    placementProp = _param.placement,\n    restProps = _object_without_properties(_param, [\"children\", \"toggleRef\", \"closing\", \"popupDirection\", \"onClose\", \"className\", \"style\", \"popupOffsetDistance\", \"placement\"]);\n  var document = useDOM().document;\n  var platform = usePlatform();\n  var sizeY = useAdaptivityWithJSMediaQueries().sizeY;\n  var elementRef = React.useRef(null);\n  useEffectDev(function () {\n    var toggleEl = getEl(toggleRef);\n    if (!toggleEl) {\n      warn('Свойство \"toggleRef\" не передано', \"error\");\n    }\n  }, [toggleRef]);\n  var isPopupDirectionTop = React.useMemo(function () {\n    return popupDirection === \"top\" || typeof popupDirection === \"function\" && popupDirection(elementRef) === \"top\";\n  }, [popupDirection, elementRef]);\n  var placement = placementProp !== null && placementProp !== void 0 ? placementProp : isPopupDirectionTop ? \"top-end\" : \"bottom-end\";\n  var bodyClickListener = useEventListener(\"click\", function (e) {\n    var dropdownElement = elementRef === null || elementRef === void 0 ? void 0 : elementRef.current;\n    if (dropdownElement && !dropdownElement.contains(e.target)) {\n      onClose === null || onClose === void 0 ? void 0 : onClose();\n    }\n  });\n  React.useEffect(function () {\n    setTimeout(function () {\n      bodyClickListener.add(document.body);\n    });\n  }, [bodyClickListener, document]);\n  var onClick = React.useCallback(function (e) {\n    return e.stopPropagation();\n  }, []);\n  var targetRef = React.useMemo(function () {\n    if (isRefObject(toggleRef)) {\n      return toggleRef;\n    }\n    return {\n      current: toggleRef\n    };\n  }, [toggleRef]);\n  return /*#__PURE__*/React.createElement(Popper, {\n    targetRef: targetRef,\n    offsetDistance: popupOffsetDistance,\n    placement: placement,\n    className: classNames(\"vkuiActionSheet\", platform === Platform.IOS && \"vkuiActionSheet--ios\", \"vkuiActionSheet--menu\", sizeY === SizeType.COMPACT && \"vkuiActionSheet--sizeY-compact\", className),\n    style: style,\n    getRef: elementRef,\n    forcePortal: false\n  }, /*#__PURE__*/React.createElement(FocusTrap, _object_spread_props(_object_spread({\n    onClose: onClose\n  }, restProps), {\n    onClick: onClick\n  }), children));\n};","map":{"version":3,"names":["React","classNames","useAdaptivityWithJSMediaQueries","useEffectDev","useEventListener","usePlatform","SizeType","useDOM","isRefObject","Platform","warnOnce","FocusTrap","Popper","warn","getEl","ref","current","ActionSheetDropdownMenu","_param","children","toggleRef","closing","popupDirection","onClose","className","style","_param_popupOffsetDistance","popupOffsetDistance","placementProp","placement","restProps","_object_without_properties","document","platform","sizeY","elementRef","useRef","toggleEl","isPopupDirectionTop","useMemo","bodyClickListener","e","dropdownElement","contains","target","useEffect","setTimeout","add","body","onClick","useCallback","stopPropagation","targetRef","createElement","offsetDistance","IOS","COMPACT","getRef","forcePortal","_object_spread_props","_object_spread"],"sources":["../../../src/components/ActionSheet/ActionSheetDropdownMenu.tsx"],"sourcesContent":["import * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport { useAdaptivityWithJSMediaQueries } from '../../hooks/useAdaptivityWithJSMediaQueries';\nimport { useEffectDev } from '../../hooks/useEffectDev';\nimport { useEventListener } from '../../hooks/useEventListener';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport { SizeType } from '../../lib/adaptivity';\nimport { useDOM } from '../../lib/dom';\nimport { isRefObject } from '../../lib/isRefObject';\nimport { Platform } from '../../lib/platform';\nimport { warnOnce } from '../../lib/warnOnce';\nimport { FocusTrap } from '../FocusTrap/FocusTrap';\nimport { Popper } from '../Popper/Popper';\nimport { SharedDropdownProps } from './types';\nimport styles from './ActionSheet.module.css';\n\nconst warn = warnOnce('ActionSheet');\nfunction getEl(ref: SharedDropdownProps['toggleRef']): Element | null | undefined {\n  return ref && 'current' in ref ? ref.current : ref;\n}\n\nexport const ActionSheetDropdownMenu = ({\n  children,\n  toggleRef,\n  closing,\n  popupDirection,\n  onClose,\n  className,\n  style,\n  popupOffsetDistance = 0,\n  placement: placementProp,\n  ...restProps\n}: SharedDropdownProps) => {\n  const { document } = useDOM();\n  const platform = usePlatform();\n  const { sizeY } = useAdaptivityWithJSMediaQueries();\n  const elementRef = React.useRef<HTMLDivElement | null>(null);\n\n  useEffectDev(() => {\n    const toggleEl = getEl(toggleRef);\n    if (!toggleEl) {\n      warn(`Свойство \"toggleRef\" не передано`, 'error');\n    }\n  }, [toggleRef]);\n\n  const isPopupDirectionTop = React.useMemo(\n    () =>\n      popupDirection === 'top' ||\n      (typeof popupDirection === 'function' && popupDirection(elementRef) === 'top'),\n    [popupDirection, elementRef],\n  );\n\n  const placement = placementProp ?? (isPopupDirectionTop ? 'top-end' : 'bottom-end');\n\n  const bodyClickListener = useEventListener('click', (e: MouseEvent) => {\n    const dropdownElement = elementRef?.current;\n    if (dropdownElement && !dropdownElement.contains(e.target as Node)) {\n      onClose?.();\n    }\n  });\n\n  React.useEffect(() => {\n    setTimeout(() => {\n      bodyClickListener.add(document!.body);\n    });\n  }, [bodyClickListener, document]);\n\n  const onClick = React.useCallback((e: React.MouseEvent<HTMLElement>) => e.stopPropagation(), []);\n\n  const targetRef = React.useMemo(() => {\n    if (isRefObject<SharedDropdownProps['toggleRef'], HTMLElement>(toggleRef)) {\n      return toggleRef;\n    }\n\n    return { current: toggleRef as HTMLElement };\n  }, [toggleRef]);\n\n  return (\n    <Popper\n      targetRef={targetRef}\n      offsetDistance={popupOffsetDistance}\n      placement={placement}\n      className={classNames(\n        styles['ActionSheet'],\n        platform === Platform.IOS && styles['ActionSheet--ios'],\n        styles['ActionSheet--menu'],\n        sizeY === SizeType.COMPACT && styles['ActionSheet--sizeY-compact'],\n        className,\n      )}\n      style={style}\n      getRef={elementRef}\n      forcePortal={false}\n    >\n      <FocusTrap onClose={onClose} {...restProps} onClick={onClick}>\n        {children}\n      </FocusTrap>\n    </Popper>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}