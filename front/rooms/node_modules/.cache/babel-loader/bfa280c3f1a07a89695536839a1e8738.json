{"ast":null,"code":"var _jsxFileName = \"/Users/mirustal/Documents/project/rooms/front/rooms/src/components/views/Channels/ChannelView.jsx\",\n    _s = $RefreshSig$();\n\nimport { Icon16DeleteOutline, Icon16PenOutline, Icon24RefreshOutline, Icon28VolumeOutline } from \"@vkontakte/icons\";\nimport { IconButton, SimpleCell, Tooltip } from \"@vkontakte/vkui\";\nimport { joinCall } from \"../../../bridge/bridgeLib\";\nimport { Locales } from \"../../../locales/locales\";\nimport { useContext, useEffect, useState } from \"react\";\nimport { AlertManagerContext, TipAlert } from \"../../contexts/AlertProvider\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function ChannelView(_ref) {\n  _s();\n\n  let {\n    channel,\n    channelIndex,\n    renameToChannel,\n    editModeActive,\n    deleteToChannel,\n    refreshChannel,\n    userIsAdmin\n  } = _ref;\n  const [isTipShown, setTipShown] = useState(channelIndex === 0);\n  const alerts = useContext(AlertManagerContext);\n  useEffect(() => {\n    handleTipCounter();\n  }, []);\n\n  const handleTipCounter = () => {\n    let counter = localStorage.getItem(\"tipCounter\");\n\n    if (counter == null) {\n      localStorage.setItem(\"tipCounter\", \"1\");\n      return;\n    }\n\n    let counterVal = JSON.parse(counter);\n\n    if (counterVal > 3) {\n      setTipShown(false);\n    }\n\n    localStorage.setItem(\"tipCounter\", JSON.stringify(counterVal + 1));\n  };\n\n  const joinChannel = () => {\n    joinCall(channel.joinlink, () => {});\n  };\n\n  const handleChannelClick = () => {\n    if (!userIsAdmin) {\n      joinChannel();\n      return;\n    }\n\n    checkFirstCall();\n  };\n\n  const checkFirstCall = () => {\n    let isFirstCall = localStorage.getItem(\"isFirstCall\");\n\n    if (isFirstCall == null) {\n      localStorage.setItem(\"isFirstCall\", \"false\");\n      alerts.showAlert(TipAlert({\n        message: Locales.Hints.DontKillCall,\n        alertManager: alerts,\n        onClose: joinChannel\n      }));\n      return;\n    }\n\n    joinChannel();\n  };\n\n  return /*#__PURE__*/_jsxDEV(SimpleCell, {\n    before: /*#__PURE__*/_jsxDEV(Icon28VolumeOutline, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 15\n    }, this),\n    after: userIsAdmin && /*#__PURE__*/_jsxDEV(AdminActions, {\n      isTipShown: isTipShown,\n      setTipShown: setTipShown,\n      refreshChannel: refreshChannel,\n      channel: channel\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 29\n    }, this),\n    onClick: handleChannelClick,\n    children: /*#__PURE__*/_jsxDEV(ChannelName, {\n      channel: channel,\n      editModeActive: editModeActive,\n      renameToChannel: renameToChannel,\n      deleteToChannel: deleteToChannel\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ChannelView, \"Rgfvevm7N77bHWxkzQfUotp6gBM=\");\n\n_c = ChannelView;\n\nfunction AdminActions(_ref2) {\n  let {\n    isTipShown,\n    setTipShown,\n    refreshChannel,\n    channel\n  } = _ref2;\n  return /*#__PURE__*/_jsxDEV(Tooltip, {\n    isShown: isTipShown,\n    text: Locales.Hints.RefreshChannel,\n    onClick: e => e.preventDefault(),\n    onClose: () => setTipShown(false),\n    children: /*#__PURE__*/_jsxDEV(IconButton, {\n      onClick: () => refreshChannel(channel.id),\n      children: /*#__PURE__*/_jsxDEV(Icon24RefreshOutline, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 5\n  }, this);\n}\n\n_c2 = AdminActions;\n\nfunction ChannelName(_ref3) {\n  let {\n    channel,\n    editModeActive,\n    renameToChannel,\n    deleteToChannel\n  } = _ref3;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      alignItems: 'center'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"b\", {\n      children: [\"#\", channel.name]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this), editModeActive && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(IconButton, {\n        onClick: renameToChannel,\n        children: /*#__PURE__*/_jsxDEV(Icon16PenOutline, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n        style: {\n          color: 'red'\n        },\n        onClick: () => deleteToChannel(channel.id),\n        children: /*#__PURE__*/_jsxDEV(Icon16DeleteOutline, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 84,\n    columnNumber: 5\n  }, this);\n}\n\n_c3 = ChannelName;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"ChannelView\");\n$RefreshReg$(_c2, \"AdminActions\");\n$RefreshReg$(_c3, \"ChannelName\");","map":{"version":3,"names":["Icon16DeleteOutline","Icon16PenOutline","Icon24RefreshOutline","Icon28VolumeOutline","IconButton","SimpleCell","Tooltip","joinCall","Locales","useContext","useEffect","useState","AlertManagerContext","TipAlert","ChannelView","channel","channelIndex","renameToChannel","editModeActive","deleteToChannel","refreshChannel","userIsAdmin","isTipShown","setTipShown","alerts","handleTipCounter","counter","localStorage","getItem","setItem","counterVal","JSON","parse","stringify","joinChannel","joinlink","handleChannelClick","checkFirstCall","isFirstCall","showAlert","message","Hints","DontKillCall","alertManager","onClose","AdminActions","RefreshChannel","e","preventDefault","id","ChannelName","display","alignItems","name","color"],"sources":["/Users/mirustal/Documents/project/rooms/front/rooms/src/components/views/Channels/ChannelView.jsx"],"sourcesContent":["import {\n  Icon16DeleteOutline,\n  Icon16PenOutline,\n  Icon24RefreshOutline,\n  Icon28VolumeOutline,\n} from \"@vkontakte/icons\";\nimport { IconButton, SimpleCell, Tooltip } from \"@vkontakte/vkui\";\nimport { joinCall } from \"../../../bridge/bridgeLib\";\nimport { Locales } from \"../../../locales/locales\";\nimport { useContext, useEffect, useState } from \"react\";\nimport { AlertManagerContext, TipAlert } from \"../../contexts/AlertProvider\";\n\nexport default function ChannelView({ channel, channelIndex, renameToChannel, editModeActive, deleteToChannel, refreshChannel, userIsAdmin }) {\n  const [isTipShown, setTipShown] = useState(channelIndex === 0);\n  const alerts = useContext(AlertManagerContext);\n\n  useEffect(() => {\n    handleTipCounter();\n  }, []);\n\n  const handleTipCounter = () => {\n    let counter = localStorage.getItem(\"tipCounter\");\n    if (counter == null) {\n      localStorage.setItem(\"tipCounter\", \"1\");\n      return;\n    }\n    let counterVal = JSON.parse(counter);\n    if (counterVal > 3) {\n      setTipShown(false);\n    }\n    localStorage.setItem(\"tipCounter\", JSON.stringify(counterVal + 1));\n  };\n\n  const joinChannel = () => {\n    joinCall(channel.joinlink, () => {});\n  };\n\n  const handleChannelClick = () => {\n    if (!userIsAdmin) {\n      joinChannel();\n      return;\n    }\n    checkFirstCall();\n  };\n\n  const checkFirstCall = () => {\n    let isFirstCall = localStorage.getItem(\"isFirstCall\");\n    if (isFirstCall == null) {\n      localStorage.setItem(\"isFirstCall\", \"false\");\n      alerts.showAlert(TipAlert({ message: Locales.Hints.DontKillCall, alertManager: alerts, onClose: joinChannel }));\n      return;\n    }\n    joinChannel();\n  };\n\n  return (\n    <SimpleCell\n      before={<Icon28VolumeOutline />}\n      after={userIsAdmin && <AdminActions isTipShown={isTipShown} setTipShown={setTipShown} refreshChannel={refreshChannel} channel={channel} />}\n      onClick={handleChannelClick}\n    >\n      <ChannelName channel={channel} editModeActive={editModeActive} renameToChannel={renameToChannel} deleteToChannel={deleteToChannel} />\n    </SimpleCell>\n  );\n}\n\nfunction AdminActions({ isTipShown, setTipShown, refreshChannel, channel }) {\n  return (\n    <Tooltip\n      isShown={isTipShown}\n      text={Locales.Hints.RefreshChannel}\n      onClick={e => e.preventDefault()}\n      onClose={() => setTipShown(false)}\n    >\n      <IconButton onClick={() => refreshChannel(channel.id)}>\n        <Icon24RefreshOutline />\n      </IconButton>\n    </Tooltip>\n  );\n}\n\nfunction ChannelName({ channel, editModeActive, renameToChannel, deleteToChannel }) {\n  return (\n    <div style={{ display: 'flex', alignItems: 'center' }}>\n      <b>#{channel.name}</b>\n      {editModeActive && (\n        <>\n          <IconButton onClick={renameToChannel}>\n            <Icon16PenOutline />\n          </IconButton>\n          <IconButton style={{ color: 'red' }} onClick={() => deleteToChannel(channel.id)}>\n            <Icon16DeleteOutline />\n          </IconButton>\n        </>\n      )}\n    </div>\n  );\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}